/**
 * The MIT License (MIT)
 * 
 * Copyright (c) 2015 Famous Industries Inc.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
!function t(e,i,s){function r(o,a){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(n)return n(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[o]={exports:{}};e[o][0].call(l.exports,function(t){var i=e[o][1][t];return r(i?i:t)},l,l.exports,t,e,i,s)}return i[o].exports}for(var n="function"==typeof require&&require,o=0;o<s.length;o++)r(s[o]);return r}({1:[function(t,e,i){"use strict";function s(t){this._node=t,this._projectionType=s.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this._requestingUpdate=!1,this._id=t.addComponent(this),this._viewTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._viewDirty=!1,this._perspectiveDirty=!1,this.setFlat()}s.FRUSTUM_PROJECTION=0,s.PINHOLE_PROJECTION=1,s.ORTHOGRAPHIC_PROJECTION=2,s.prototype.toString=function(){return"Camera"},s.prototype.getValue=function(){return{component:this.toString(),projectionType:this._projectionType,focalDepth:this._focalDepth,near:this._near,far:this._far}},s.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.projectionType,t.focalDepth,t.near,t.far),!0):!1},s.prototype.set=function(t,e,i,s){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._projectionType=t,this._focalDepth=e,this._near=i,this._far=s},s.prototype.setDepth=function(t){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=s.PINHOLE_PROJECTION,this._focalDepth=t,this._near=0,this._far=0,this},s.prototype.setFrustum=function(t,e){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=s.FRUSTUM_PROJECTION,this._focalDepth=0,this._near=t,this._far=e,this},s.prototype.setFlat=function(){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=s.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this},s.prototype.onUpdate=function(){this._requestingUpdate=!1;var t=this._node.getLocation();if(this._node.sendDrawCommand("WITH").sendDrawCommand(t),this._perspectiveDirty)switch(this._perspectiveDirty=!1,this._projectionType){case s.FRUSTUM_PROJECTION:this._node.sendDrawCommand("FRUSTUM_PROJECTION"),this._node.sendDrawCommand(this._near),this._node.sendDrawCommand(this._far);break;case s.PINHOLE_PROJECTION:this._node.sendDrawCommand("PINHOLE_PROJECTION"),this._node.sendDrawCommand(this._focalDepth);break;case s.ORTHOGRAPHIC_PROJECTION:this._node.sendDrawCommand("ORTHOGRAPHIC_PROJECTION")}this._viewDirty&&(this._viewDirty=!1,this._node.sendDrawCommand("CHANGE_VIEW_TRANSFORM"),this._node.sendDrawCommand(this._viewTransform[0]),this._node.sendDrawCommand(this._viewTransform[1]),this._node.sendDrawCommand(this._viewTransform[2]),this._node.sendDrawCommand(this._viewTransform[3]),this._node.sendDrawCommand(this._viewTransform[4]),this._node.sendDrawCommand(this._viewTransform[5]),this._node.sendDrawCommand(this._viewTransform[6]),this._node.sendDrawCommand(this._viewTransform[7]),this._node.sendDrawCommand(this._viewTransform[8]),this._node.sendDrawCommand(this._viewTransform[9]),this._node.sendDrawCommand(this._viewTransform[10]),this._node.sendDrawCommand(this._viewTransform[11]),this._node.sendDrawCommand(this._viewTransform[12]),this._node.sendDrawCommand(this._viewTransform[13]),this._node.sendDrawCommand(this._viewTransform[14]),this._node.sendDrawCommand(this._viewTransform[15]))},s.prototype.onTransformChange=function(t){var e=t;this._viewDirty=!0,this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var i=e[0],s=e[1],r=e[2],n=e[3],o=e[4],a=e[5],h=e[6],u=e[7],l=e[8],c=e[9],p=e[10],d=e[11],f=e[12],m=e[13],g=e[14],_=e[15],v=i*a-s*o,y=i*h-r*o,b=i*u-n*o,w=s*h-r*a,x=s*u-n*a,T=r*u-n*h,C=l*m-c*f,E=l*g-p*f,S=l*_-d*f,R=c*g-p*m,M=c*_-d*m,A=p*_-d*g,z=1/(v*A-y*M+b*R+w*S-x*E+T*C);this._viewTransform[0]=(a*A-h*M+u*R)*z,this._viewTransform[1]=(r*M-s*A-n*R)*z,this._viewTransform[2]=(m*T-g*x+_*w)*z,this._viewTransform[3]=(p*x-c*T-d*w)*z,this._viewTransform[4]=(h*S-o*A-u*E)*z,this._viewTransform[5]=(i*A-r*S+n*E)*z,this._viewTransform[6]=(g*b-f*T-_*y)*z,this._viewTransform[7]=(l*T-p*b+d*y)*z,this._viewTransform[8]=(o*M-a*S+u*C)*z,this._viewTransform[9]=(s*S-i*M-n*C)*z,this._viewTransform[10]=(f*x-m*b+_*v)*z,this._viewTransform[11]=(c*b-l*x-d*v)*z,this._viewTransform[12]=(a*E-o*R-h*C)*z,this._viewTransform[13]=(i*R-s*E+r*C)*z,this._viewTransform[14]=(m*y-f*w-g*v)*z,this._viewTransform[15]=(l*w-c*y+p*v)*z},e.exports=s},{}],2:[function(t,e,i){"use strict";function s(t,e){this.node=t,this.id=t.addComponent(this),this._events=new h,this.last1=new u,this.last2=new u,this.delta1=new u,this.delta2=new u,this.velocity1=new u,this.velocity2=new u,this.dist=0,this.diff12=new u,this.center=new u,this.centerDelta=new u,this.centerVelocity=new u,this.pointer1={position:this.last1,delta:this.delta1,velocity:this.velocity1},this.pointer2={position:this.last2,delta:this.delta2,velocity:this.velocity2},this.event={status:null,time:0,pointers:[],center:this.center,centerDelta:this.centerDelta,centerVelocity:this.centerVelocity,points:0,current:0},this.trackedPointerIDs=[-1,-1],this.timeOfPointer=0,this.multiTap=0,this.mice=[],this.gestures=[],this.options={},this.trackedGestures={};var i,s;if(e)for(i=0,s=e.length;s>i;i++)this.on(e[i],e[i].callback);t.addUIEvent("touchstart"),t.addUIEvent("mousedown"),t.addUIEvent("touchmove"),t.addUIEvent("mousemove"),t.addUIEvent("touchend"),t.addUIEvent("mouseup"),t.addUIEvent("mouseleave")}function r(t){var e;if(t.targetTouches?e=t.targetTouches:(this.mice[0]=t,e=this.mice,t.identifier=1),!e[0]||!e[1]||this.trackedPointerIDs[0]!==e[0].identifier||this.trackedPointerIDs[1]!==e[1].identifier){this.event.time=Date.now();var i,s;this.trackedPointerIDs[0]!==e[0].identifier&&(this.trackedGestures.tap&&(i=this.options.tap&&this.options.tap.threshold||250,this.event.time-this.timeOfPointer<i?this.event.taps++:this.event.taps=1,this.timeOfPointer=this.event.time,this.multiTap=1),this.event.current=1,this.event.points=1,s=e[0].identifier,this.trackedPointerIDs[0]=s,this.last1.set(e[0].pageX,e[0].pageY),this.velocity1.clear(),this.delta1.clear(),this.event.pointers.push(this.pointer1)),e[1]&&this.trackedPointerIDs[1]!==e[1].identifier&&(this.trackedGestures.tap&&(i=this.options.tap&&this.options.tap.threshold||250,this.event.time-this.timeOfPointer<i&&(this.multiTap=2)),this.event.current=2,this.event.points=2,s=e[1].identifier,this.trackedPointerIDs[1]=s,this.last2.set(e[1].pageX,e[1].pageY),this.velocity2.clear(),this.delta2.clear(),u.add(this.last1,this.last2,this.center).scale(.5),this.centerDelta.clear(),this.centerVelocity.clear(),u.subtract(this.last2,this.last1,this.diff12),this.dist=this.diff12.length(),this.trackedGestures.pinch&&(this.event.scale=this.event.scale||1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=this.event.rotation||0,this.event.rotationDelta=0,this.event.rotationVelocity=0),this.event.pointers.push(this.pointer2)),this.event.status="start",1===this.event.points&&(this.center.copy(this.last1),this.centerDelta.clear(),this.centerVelocity.clear(),this.trackedGestures.pinch&&(this.event.scale=1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=0,this.event.rotationDelta=0,this.event.rotationVelocity=0)),this.triggerGestures()}}function n(t){var e;if(t.targetTouches)e=t.targetTouches;else{if(!this.event.current)return;this.mice[0]=t,e=this.mice,t.identifier=1}var i=Date.now(),s=i-this.event.time;if(0!==s){var r=1e3/s;if(this.event.time=i,this.event.current=1,this.event.points=1,this.trackedPointerIDs[0]===e[0].identifier&&(l.set(e[0].pageX,e[0].pageY),u.subtract(l,this.last1,this.delta1),u.scale(this.delta1,r,this.velocity1),this.last1.copy(l)),e[1]){if(this.event.current=2,this.event.points=2,l.set(e[1].pageX,e[1].pageY),u.subtract(l,this.last2,this.delta2),u.scale(this.delta2,r,this.velocity2),this.last2.copy(l),u.add(this.last1,this.last2,l).scale(.5),u.subtract(l,this.center,this.centerDelta),u.add(this.velocity1,this.velocity2,this.centerVelocity).scale(.5),this.center.copy(l),u.subtract(this.last2,this.last1,l),this.trackedGestures.rotate){var n=l.dot(this.diff12),o=l.cross(this.diff12),a=-Math.atan2(o,n);this.event.rotation+=a,this.event.rotationDelta=a,this.event.rotationVelocity=a*r}var h=l.length(),c=h/this.dist;this.diff12.copy(l),this.dist=h,this.trackedGestures.pinch&&(this.event.scale*=c,c-=1,this.event.scaleDelta=c,this.event.scaleVelocity=c*r)}this.event.status="move",1===this.event.points&&(this.center.copy(this.last1),this.centerDelta.copy(this.delta1),this.centerVelocity.copy(this.velocity1),this.trackedGestures.pinch&&(this.event.scale=1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=0,this.event.rotationDelta=0,this.event.rotationVelocity=0)),this.triggerGestures()}}function o(t){var e;if(t.targetTouches)e=t.targetTouches;else{if(!this.event.current)return;this.mice.pop(),e=this.mice}if(!e[0]||!e[1]||this.trackedPointerIDs[0]!==e[0].identifier||this.trackedPointerIDs[1]!==e[1].identifier){var i;if(this.event.status="end",!e[0])return this.event.current=0,this.trackedPointerIDs[0]=-1,this.trackedPointerIDs[1]=-1,this.triggerGestures(),this.event.pointers.pop(),void this.event.pointers.pop();this.trackedPointerIDs[0]!==e[0].identifier&&(this.trackedPointerIDs[0]=-1,i=e[0].identifier,this.trackedPointerIDs[0]=i,this.last1.set(e[0].pageX,e[0].pageY),this.velocity1.clear(),this.delta1.clear()),e[1]?this.trackedPointerIDs[1]!==e[1].identifier&&(this.trackedPointerIDs[1]=-1,this.event.points=2,i=e[1].identifier,this.trackedPointerIDs[1]=i,this.last2.set(e[1].pageX,e[1].pageY),this.velocity2.clear(),this.delta2.clear(),u.add(this.last1,this.last2,this.center).scale(.5),this.centerDelta.clear(),this.centerVelocity.clear(),u.subtract(this.last2,this.last1,this.diff12),this.dist=this.diff12.length()):(this.event.current=1,this.trackedPointerIDs[1]=-1,this.triggerGestures(),this.event.points=1,this.event.pointers.pop())}}function a(){this.event.current&&(this.event.status="end",this.event.current=0,this.trackedPointerIDs[0]=-1,this.triggerGestures(),this.event.pointers.pop())}var h=t("../utilities/CallbackStore"),u=t("../math/Vec2"),l=new u,c={drag:!0,tap:!0,rotate:!0,pinch:!0};s.prototype.onReceive=function(t,e){switch(t){case"touchstart":case"mousedown":r.call(this,e);break;case"touchmove":case"mousemove":n.call(this,e);break;case"touchend":case"mouseup":o.call(this,e);break;case"mouseleave":a.call(this,e)}},s.prototype.toString=function(){return"GestureHandler"},s.prototype.on=function(t,e){var i=t.event||t;c[i]&&(this.trackedGestures[i]=!0,this.gestures.push(i),t.event&&(this.options[i]=t),this._events.on(i,e))},s.prototype.triggerGestures=function(){for(var t=this.event,e=0,i=this.gestures.length;i>e;e++){var s=this.gestures[e];switch(s){case"rotate":case"pinch":2===t.points&&this.trigger(s,t);break;case"tap":if("start"===t.status)if(this.options.tap){var r=this.options.tap.points||1;this.multiTap>=r&&t.points>=r&&this.trigger(s,t)}else this.trigger(s,t);break;default:this.trigger(s,t)}}},s.prototype.trigger=function(t,e){this._events.trigger(t,e)},e.exports=s},{"../math/Vec2":28,"../utilities/CallbackStore":41}],3:[function(t,e,i){"use strict";function s(t){this._node=t,this._id=t.addComponent(this),this._requestingUpdate=!1;var e=t.getPosition();this._x=new r(e[0]),this._y=new r(e[1]),this._z=new r(e[2])}var r=t("../transitions/Transitionable");s.prototype.toString=function(){return"Position"},s.prototype.getValue=function(){return{component:this.toString(),x:this._x.get(),y:this._y.get(),z:this._z.get()}},s.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.x,t.y,t.z),!0):!1},s.prototype.getX=function(){return this._x.get()},s.prototype.getY=function(){return this._y.get()},s.prototype.getZ=function(){return this._z.get()},s.prototype.isActive=function(){return this._x.isActive()||this._y.isActive()||this._z.isActive()},s.prototype._checkUpdate=function(){this.isActive()?this._node.requestUpdateOnNextTick(this._id):this._requestingUpdate=!1},s.prototype.update=function(){this._node.setPosition(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},s.prototype.onUpdate=s.prototype.update,s.prototype.setX=function(t,e,i){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._x.set(t,e,i),this},s.prototype.setY=function(t,e,i){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._y.set(t,e,i),this},s.prototype.setZ=function(t,e,i){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._z.set(t,e,i),this},s.prototype.set=function(t,e,i,s,r){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var n,o,a;return null!=i?a=r:null!=e?o=r:null!=t&&(n=r),null!=t&&this._x.set(t,s,n),null!=e&&this._y.set(e,s,o),null!=i&&this._z.set(i,s,a),this},s.prototype.halt=function(){return this._x.halt(),this._y.halt(),this._z.halt(),this},e.exports=s},{"../transitions/Transitionable":40}],4:[function(t,e,i){"use strict";function s(t){r.call(this,t);var e=t.getRotation(),i=e[0],s=e[1],n=e[2],o=e[3],a=i*i,h=s*s,u=n*n,l=2*(i*n+s*o);l=-1>l?-1:l>1?1:l;var c=Math.atan2(2*(i*o-s*n),1-2*(a+h)),p=Math.asin(l),d=Math.atan2(2*(n*o-i*s),1-2*(h+u));this._x.set(c),this._y.set(p),this._z.set(d)}var r=t("./Position");s.prototype.toString=function(){return"Rotation"},s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.update=function(){this._node.setRotation(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},s.prototype.onUpdate=s.prototype.update,e.exports=s},{"./Position":3}],5:[function(t,e,i){"use strict";function s(){"undefined"!=typeof self&&self.window!==self&&this._enterWorkerMode()}s.prototype._enterWorkerMode=function(){this._workerMode=!0;var t=this;self.addEventListener("message",function(e){t.onMessage(e.data)})},s.prototype.onMessage=null,s.prototype.sendMessage=function(t){this._workerMode?self.postMessage(t):this.onmessage(t)},s.prototype.onmessage=null,s.prototype.postMessage=function(t){return this.onMessage(t)},e.exports=s},{}],6:[function(t,e,i){"use strict";function s(){this._time=0,this._frame=0,this._timerQueue=[],this._updatingIndex=0,this._scale=1,this._scaledTime=this._time}s.prototype.setScale=function(t){return this._scale=t,this},s.prototype.getScale=function(){return this._scale},s.prototype.step=function(t){this._frame++,this._scaledTime=this._scaledTime+(t-this._time)*this._scale,this._time=t;for(var e=0;e<this._timerQueue.length;e++)this._timerQueue[e](this._scaledTime)&&this._timerQueue.splice(e,1);return this},s.prototype.now=function(){return this._scaledTime},s.prototype.getTime=s.prototype.now,s.prototype.getFrame=function(){return this._frame},s.prototype.setTimeout=function(t,e){var i=Array.prototype.slice.call(arguments,2),s=this._time,r=function(r){return r-s>=e?(t.apply(null,i),!0):!1};return this._timerQueue.push(r),r},s.prototype.setInterval=function(t,e){var i=Array.prototype.slice.call(arguments,2),s=this._time,r=function(r){return r-s>=e&&(t.apply(null,i),s=r),!1};return this._timerQueue.push(r),r},s.prototype.clearTimer=function(t){var e=this._timerQueue.indexOf(t);return-1!==e&&this._timerQueue.splice(e,1),this},e.exports=s},{}],7:[function(t,e,i){"use strict";function s(t){if(!t)throw new Error("Dispatch needs to be instantiated on a node");this._context=t,this._queue=[]}function r(t,e){e.length=0;var i,s=0,r=t.length;for(i=0;r>i;i++)"/"===t[i]&&(e.push(t.substring(s,i)),s=i+1);return i-s>0&&e.push(t.substring(s,i)),e}var n=t("./Event");s.prototype.lookupNode=function(t){if(!t)throw new Error("lookupNode must be called with a path");var e=this._queue;if(r(t,e),e[0]!==this._context.getSelector())return void 0;var i,s=this._context.getChildren(),n=1;for(e[0]=this._context;n<e.length;){if(i=s[e[n]],e[n]=i,!i)return void 0;s=i.getChildren(),n++}return i},s.prototype.dispatch=function(t,e){if(!t)throw new Error("dispatch requires an event name as it's first argument");var i,s,r,n,o=this._queue;for(o.length=0,o.push(this._context);o.length;)for(i=o.shift(),i.onReceive&&i.onReceive(t,e),n=i.getChildren(),s=0,r=n.length;r>s;s++)o.push(n[s])},s.prototype.dispatchUIEvent=function(t,e,i){if(!t)throw new Error("dispatchUIEvent needs a valid path to dispatch to");if(!e)throw new Error("dispatchUIEvent needs an event name as its second argument");var s,r=this._queue;for(n.call(i),i.node=this.lookupNode(t);r.length&&(s=r.pop(),s.onReceive&&s.onReceive(e,i),!i.propagationStopped););},e.exports=s},{"./Event":8}],8:[function(t,e,i){"use strict";function s(){this.propagationStopped=!1,this.stopPropagation=r}function r(){this.propagationStopped=!0}e.exports=s},{}],9:[function(t,e,i){"use strict";function s(){var t=this;this._updateQueue=[],this._nextUpdateQueue=[],this._scenes={},this._messages=p,this._inUpdate=!1,this._clock=new r,this._channel=new o,this._channel.onMessage=function(e){t.handleMessage(e)}}var r=t("./Clock"),n=t("./Scene"),o=t("./Channel"),a=t("../renderers/UIManager"),h=t("../renderers/Compositor"),u=t("../render-loops/RequestAnimationFrameLoop"),l=["ENGINE","START"],c=["ENGINE","STOP"],p=["TIME",null];s.prototype.init=function(t){return this.compositor=t&&t.compositor||new h,this.renderLoop=t&&t.renderLoop||new u,this.uiManager=new a(this.getChannel(),this.compositor,this.renderLoop),this},s.prototype.setChannel=function(t){return this._channel=t,this},s.prototype.getChannel=function(){return this._channel},s.prototype._update=function(){this._inUpdate=!0;var t,e=this._clock.now(),i=this._nextUpdateQueue,s=this._updateQueue;for(this._messages[1]=e;i.length;)s.unshift(i.pop());for(;s.length;)t=s.shift(),t&&t.onUpdate&&t.onUpdate(e);this._inUpdate=!1},s.prototype.requestUpdate=function(t){if(!t)throw new Error("requestUpdate must be called with a class to be updated");this._inUpdate?this.requestUpdateOnNextTick(t):this._updateQueue.push(t)},s.prototype.requestUpdateOnNextTick=function(t){this._nextUpdateQueue.push(t)},s.prototype.handleMessage=function(t){if(!t)throw new Error("onMessage must be called with an array of messages");for(var e;t.length>0;)switch(e=t.shift()){case"WITH":this.handleWith(t);break;case"FRAME":this.handleFrame(t);break;default:throw new Error("received unknown command: "+e)}return this},s.prototype.handleWith=function(t){var e=t.shift(),i=t.shift();switch(i){case"TRIGGER":var s=t.shift(),r=t.shift();this.getContext(e).getDispatch().dispatchUIEvent(e,s,r);break;default:throw new Error("received unknown command: "+i)}return this},s.prototype.handleFrame=function(t){if(!t)throw new Error("handleFrame must be called with an array of messages");if(!t.length)throw new Error("FRAME must be sent with a time");return this.step(t.shift()),this},s.prototype.step=function(t){if(null==t)throw new Error("step must be called with a time");return this._clock.step(t),this._update(),this._messages.length&&(this._channel.sendMessage(this._messages),this._messages.length=2),this},s.prototype.getContext=function(t){if(!t)throw new Error("getContext must be called with a selector");var e=t.indexOf("/");return t=-1===e?t:t.substring(0,e),this._scenes[t]},s.prototype.getClock=function(){return this._clock},s.prototype.message=function(t){return this._messages.push(t),this},s.prototype.createScene=function(t){return t=t||"body",this._scenes[t]&&this._scenes[t].dismount(),this._scenes[t]=new n(t,this),this._scenes[t]},s.prototype.startEngine=function(){return this._channel.sendMessage(l),this},s.prototype.stopEngine=function(){return this._channel.sendMessage(c),this},e.exports=new s},{"../render-loops/RequestAnimationFrameLoop":34,"../renderers/Compositor":35,"../renderers/UIManager":37,"./Channel":5,"./Clock":6,"./Scene":11}],10:[function(t,e,i){"use strict";function s(){this._calculatedValues={transform:new Float32Array(h),size:new Float32Array(3)},this._requestingUpdate=!1,this._inUpdate=!1,this._updateQueue=[],this._nextUpdateQueue=[],this._freedComponentIndicies=[],this._components=[],this._freedChildIndicies=[],this._children=[],this._parent=null,this._globalUpdater=null,this._lastEulerX=0,this._lastEulerY=0,this._lastEulerZ=0,this._lastEuler=!1,this.value=new s.Spec}var r=t("./Transform"),n=t("./Size"),o=new r,a=new n,h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[1,1,1],l=[0,0,0,1];s.RELATIVE_SIZE=n.RELATIVE,s.ABSOLUTE_SIZE=n.ABSOLUTE,s.RENDER_SIZE=n.RENDER,s.DEFAULT_SIZE=n.DEFAULT,s.Spec=function(){this.location=null,this.showState={mounted:!1,shown:!1,opacity:1},this.offsets={mountPoint:new Float32Array(3),align:new Float32Array(3),origin:new Float32Array(3)},this.vectors={position:new Float32Array(3),rotation:new Float32Array(l),scale:new Float32Array(u)},this.size={sizeMode:new Float32Array([n.RELATIVE,n.RELATIVE,n.RELATIVE]),proportional:new Float32Array(u),differential:new Float32Array(3),absolute:new Float32Array(3),render:new Float32Array(3)},this.UIEvents=[]},s.prototype.getLocation=function(){return this.value.location},s.prototype.getId=s.prototype.getLocation,s.prototype.emit=function(t,e){for(var i=this;i!==i.getParent();)i=i.getParent();return i.getDispatch().dispatch(t,e),this},s.prototype.sendDrawCommand=function(t){return this._globalUpdater.message(t),this},s.prototype.getValue=function(){for(var t=this._children.length,e=this._components.length,i=0,s={location:this.value.location,spec:this.value,components:new Array(e),children:new Array(t)};t>i;i++)this._children[i]&&this._children[i].getValue&&(s.children[i]=this._children[i].getValue());for(i=0;e>i;i++)this._components[i]&&this._components[i].getValue&&(s.components[i]=this._components[i].getValue());return s},s.prototype.getComputedValue=function(){for(var t=this._children.length,e={location:this.value.location,computedValues:this._calculatedValues,children:new Array(t)},i=0;t>i;i++)e.children[i]=this._children[i].getComputedValue();return e},s.prototype.getChildren=function(){return this._children},s.prototype.getParent=function(){return this._parent},s.prototype.requestUpdate=function(t){return this._inUpdate||!this.isMounted()?this.requestUpdateOnNextTick(t):(this._updateQueue.push(t),this._requestingUpdate||this._requestUpdate(),this)},s.prototype.requestUpdateOnNextTick=function(t){return this._nextUpdateQueue.push(t),this},s.prototype.getUpdater=function(){return this._globalUpdater},s.prototype.isMounted=function(){return this.value.showState.mounted},s.prototype.isShown=function(){return this.value.showState.shown},s.prototype.getOpacity=function(){return this.value.showState.opacity},s.prototype.getMountPoint=function(){return this.value.offsets.mountPoint},s.prototype.getAlign=function(){return this.value.offsets.align},s.prototype.getOrigin=function(){return this.value.offsets.origin},s.prototype.getPosition=function(){return this.value.vectors.position},s.prototype.getRotation=function(){return this.value.vectors.rotation},s.prototype.getScale=function(){return this.value.vectors.scale},s.prototype.getSizeMode=function(){return this.value.size.sizeMode},s.prototype.getProportionalSize=function(){return this.value.size.proportional},s.prototype.getDifferentialSize=function(){return this.value.size.differential},s.prototype.getAbsoluteSize=function(){return this.value.size.absolute},s.prototype.getRenderSize=function(){return this.value.size.render},s.prototype.getSize=function(){return this._calculatedValues.size},s.prototype.getTransform=function(){return this._calculatedValues.transform},s.prototype.getUIEvents=function(){return this.value.UIEvents},s.prototype.addChild=function(t){var e=t?this._children.indexOf(t):-1;if(t=t?t:new s,-1===e&&(e=this._freedChildIndicies.length?this._freedChildIndicies.pop():this._children.length,this._children[e]=t,this.isMounted()&&t.onMount)){var i=this.getId(),r=i+"/"+e;t.onMount(this,r)}return t},s.prototype.removeChild=function(t){var e=this._children.indexOf(t),i=-1!==e;return i&&(this._freedChildIndicies.push(e),this._children[e]=null,this.isMounted()&&t.onDismount&&t.onDismount()),i},s.prototype.addComponent=function(t){var e=this._components.indexOf(t);return-1===e&&(e=this._freedComponentIndicies.length?this._freedComponentIndicies.pop():this._components.length,this._components[e]=t,this.isMounted()&&t.onMount&&t.onMount(this,e),this.isShown()&&t.onShow&&t.onShow()),e},s.prototype.getComponent=function(t){return this._components[t]},s.prototype.removeComponent=function(t){var e=this._components.indexOf(t);return-1!==e&&(this._freedComponentIndicies.push(e),this.isShown()&&t.onHide&&t.onHide(),this.isMounted()&&t.onDismount&&t.onDismount(),this._components[e]=null),t},s.prototype.addUIEvent=function(t){var e,i=this.getUIEvents(),s=this._components,r=-1!==i.indexOf(t);if(!r){i.push(t);for(var n=0,o=s.length;o>n;n++)e=s[n],e&&e.onAddUIEvent&&e.onAddUIEvent(t)}},s.prototype._requestUpdate=function(t){(t||!this._requestingUpdate&&this._globalUpdater)&&(this._globalUpdater.requestUpdate(this),this._requestingUpdate=!0)},s.prototype._vecOptionalSet=function(t,e,i){return null!=i&&t[e]!==i?(t[e]=i,this._requestingUpdate||this._requestUpdate(),!0):!1},s.prototype.show=function(){var t,e=0,i=this._components,s=i.length;for(this.value.showState.shown=!0;s>e;e++)t=i[e],t&&t.onShow&&t.onShow();for(e=0,i=this._children,s=i.length;s>e;e++)t=i[e],t&&t.onParentShow&&t.onParentShow();return this},s.prototype.hide=function(){var t,e=0,i=this._components,s=i.length;for(this.value.showState.shown=!1;s>e;e++)t=i[e],t&&t.onHide&&t.onHide();for(e=0,i=this._children,s=i.length;s>e;e++)t=i[e],t&&t.onParentHide&&t.onParentHide();return this},s.prototype.setAlign=function(t,e,i){var s=this.value.offsets.align,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,null!=i&&(r=this._vecOptionalSet(s,2,i-.5)||r),r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onAlignChange&&n.onAlignChange(t,e,i)}return this},s.prototype.setMountPoint=function(t,e,i){var s=this.value.offsets.mountPoint,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,null!=i&&(r=this._vecOptionalSet(s,2,i-.5)||r),r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onMountPointChange&&n.onMountPointChange(t,e,i)}return this},s.prototype.setOrigin=function(t,e,i){var s=this.value.offsets.origin,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,null!=i&&(r=this._vecOptionalSet(s,2,i-.5)||r),r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onOriginChange&&n.onOriginChange(t,e,i)}return this},s.prototype.setPosition=function(t,e,i){var s=this.value.vectors.position,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,r=this._vecOptionalSet(s,2,i)||r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onPositionChange&&n.onPositionChange(t,e,i)}return this},s.prototype.setRotation=function(t,e,i,s){var r,n,o,a,h=this.value.vectors.rotation,u=!1;if(null!=s)r=t,n=e,o=i,a=s,this._lastEulerX=null,this._lastEulerY=null,this._lastEulerZ=null,this._lastEuler=!1;else{if(null==t||null==e||null==i)if(this._lastEuler)t=null==t?this._lastEulerX:t,e=null==e?this._lastEulerY:e,i=null==i?this._lastEulerZ:i;else{var l=-2*(h[1]*h[2]-h[3]*h[0]);Math.abs(l)>.99999?(e=null==e?.5*Math.PI*l:e,t=null==t?Math.atan2(-h[0]*h[2]+h[3]*h[1],.5-h[1]*h[1]-h[2]*h[2]):t,i=null==i?0:i):(e=null==e?Math.asin(l):e,t=null==t?Math.atan2(h[0]*h[2]+h[3]*h[1],.5-h[0]*h[0]-h[1]*h[1]):t,i=null==i?Math.atan2(h[0]*h[1]+h[3]*h[2],.5-h[0]*h[0]-h[2]*h[2]):i)}var c=.5*t,p=.5*e,d=.5*i,f=Math.sin(c),m=Math.sin(p),g=Math.sin(d),_=Math.cos(c),v=Math.cos(p),y=Math.cos(d),b=m*g,w=v*g,x=m*y,T=v*y;r=f*T+_*b,n=_*x-f*w,o=_*w+f*x,a=_*T-f*b,this._lastEuler=!0,this._lastEulerX=t,this._lastEulerY=e,this._lastEulerZ=i}if(u=this._vecOptionalSet(h,0,r)||u,u=this._vecOptionalSet(h,1,n)||u,u=this._vecOptionalSet(h,2,o)||u,u=this._vecOptionalSet(h,3,a)||u){var C,E=0,S=this._components,R=S.length;for(t=h[0],e=h[1],i=h[2],s=h[3];R>E;E++)C=S[E],C&&C.onRotationChange&&C.onRotationChange(t,e,i,s)}return this},s.prototype.setScale=function(t,e,i){var s=this.value.vectors.scale,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,r=this._vecOptionalSet(s,2,i)||r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onScaleChange&&n.onScaleChange(t,e,i)}return this},s.prototype.setOpacity=function(t){if(t!==this.value.showState.opacity){this.value.showState.opacity=t,this._requestingUpdate||this._requestUpdate();for(var e,i=0,s=this._components,r=s.length;r>i;i++)e=s[i],e&&e.onOpacityChange&&e.onOpacityChange(t)}return this},s.prototype.setSizeMode=function(t,e,i){var s=this.value.size.sizeMode,r=!1;if(null!=t&&(r=this._resolveSizeMode(s,0,t)||r),null!=e&&(r=this._resolveSizeMode(s,1,e)||r),null!=i&&(r=this._resolveSizeMode(s,2,i)||r),r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onSizeModeChange&&n.onSizeModeChange(t,e,i)}return this},s.prototype._resolveSizeMode=function(t,e,i){if(i.constructor!==String)return this._vecOptionalSet(t,e,i);switch(i.toLowerCase()){case"relative":case"default":return this._vecOptionalSet(t,e,0);case"absolute":return this._vecOptionalSet(t,e,1);case"render":return this._vecOptionalSet(t,e,2);default:throw new Error("unknown size mode: "+i)}},s.prototype.setProportionalSize=function(t,e,i){var s=this.value.size.proportional,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,r=this._vecOptionalSet(s,2,i)||r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onProportionalSizeChange&&n.onProportionalSizeChange(t,e,i)}return this},s.prototype.setDifferentialSize=function(t,e,i){var s=this.value.size.differential,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,r=this._vecOptionalSet(s,2,i)||r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onDifferentialSizeChange&&n.onDifferentialSizeChange(t,e,i)}return this},s.prototype.setAbsoluteSize=function(t,e,i){var s=this.value.size.absolute,r=!1;if(r=this._vecOptionalSet(s,0,t)||r,r=this._vecOptionalSet(s,1,e)||r,r=this._vecOptionalSet(s,2,i)||r){var n,o=0,a=this._components,h=a.length;for(t=s[0],e=s[1],i=s[2];h>o;o++)n=a[o],n&&n.onAbsoluteSizeChange&&n.onAbsoluteSizeChange(t,e,i)}return this},s.prototype._transformChanged=function(t){for(var e,i=0,s=this._components,r=s.length;r>i;i++)e=s[i],e&&e.onTransformChange&&e.onTransformChange(t);for(i=0,s=this._children,r=s.length;r>i;i++)e=s[i],e&&e.onParentTransformChange&&e.onParentTransformChange(t)},s.prototype._sizeChanged=function(t){for(var e,i=0,s=this._components,r=s.length;r>i;i++)e=s[i],e&&e.onSizeChange&&e.onSizeChange(t);for(i=0,s=this._children,r=s.length;r>i;i++)e=s[i],e&&e.onParentSizeChange&&e.onParentSizeChange(t)},s.prototype.getFrame=function(){return this._globalUpdater.getFrame()},s.prototype.getComponents=function(){return this._components},s.prototype.update=function(t){this._inUpdate=!0;for(var e,i=this._nextUpdateQueue,s=this._updateQueue;i.length;)s.unshift(i.pop());for(;s.length;)e=this._components[s.shift()],e&&e.onUpdate&&e.onUpdate(t);var r=this.getSize(),n=this.getTransform(),h=this.getParent(),u=h.getSize(),l=h.getTransform(),c=a.fromSpecWithParent(u,this,r),p=o.fromSpecWithParent(l,this.value,r,u,n);return p&&this._transformChanged(n),c&&this._sizeChanged(r),this._inUpdate=!1,this._requestingUpdate=!1,this.isMounted()?this._nextUpdateQueue.length&&(this._globalUpdater.requestUpdateOnNextTick(this),
this._requestingUpdate=!0):(this._parent=null,this.value.location=null,this._globalUpdater=null),this},s.prototype.mount=function(t,e){if(this.isMounted())return this;var i,s=0,r=this._components,n=r.length;for(this._parent=t,this._globalUpdater=t.getUpdater(),this.value.location=e,this.value.showState.mounted=!0;n>s;s++)i=r[s],i&&i.onMount&&i.onMount(this,s);for(s=0,r=this._children,n=r.length;n>s;s++)i=r[s],i&&i.onParentMount&&i.onParentMount(this,e,s);return this._requestingUpdate||this._requestUpdate(!0),this},s.prototype.dismount=function(){if(!this.isMounted())return this;var t,e=0,i=this._components,s=i.length;for(this.value.showState.mounted=!1,this._parent.removeChild(this);s>e;e++)t=i[e],t&&t.onDismount&&t.onDismount();for(e=0,i=this._children,s=i.length;s>e;e++)t=i[e],t&&t.onParentDismount&&t.onParentDismount();return this._requestingUpdate||this._requestUpdate(),this},s.prototype.onParentMount=function(t,e,i){return this.mount(t,e+"/"+i)},s.prototype.onParentDismount=function(){return this.dismount()},s.prototype.receive=function(t,e){for(var i,s=0,r=this._components,n=r.length;n>s;s++)i=r[s],i&&i.onReceive&&i.onReceive(t,e);return this},s.prototype._requestUpdateWithoutArgs=function(){this._requestingUpdate||this._requestUpdate()},s.prototype.onUpdate=s.prototype.update,s.prototype.onParentShow=s.prototype.show,s.prototype.onParentHide=s.prototype.hide,s.prototype.onParentTransformChange=s.prototype._requestUpdateWithoutArgs,s.prototype.onParentSizeChange=s.prototype._requestUpdateWithoutArgs,s.prototype.onShow=s.prototype.show,s.prototype.onHide=s.prototype.hide,s.prototype.onMount=s.prototype.mount,s.prototype.onDismount=s.prototype.dismount,s.prototype.onReceive=s.prototype.receive,e.exports=s},{"./Size":12,"./Transform":13}],11:[function(t,e,i){"use strict";function s(t,e){if(!t)throw new Error("Scene needs to be created with a DOM selector");if(!e)throw new Error("Scene needs to be created with a class like Famous");n.call(this),this._updater=e,this._dispatch=new r(this),this._selector=t,this.onMount(this,t),this._updater.message("NEED_SIZE_FOR").message(t),this.show()}var r=t("./Dispatch"),n=t("./Node"),o=t("./Size");s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.getUpdater=function(){return this._updater},s.prototype.getSelector=function(){return this._selector},s.prototype.getDispatch=function(){return this._dispatch},s.prototype.onReceive=function(t,e){if("CONTEXT_RESIZE"===t){if(e.length<2)throw new Error("CONTEXT_RESIZE's payload needs to be at least a pair of pixel sizes");this.setSizeMode(o.ABSOLUTE,o.ABSOLUTE,o.ABSOLUTE),this.setAbsoluteSize(e[0],e[1],e[2]?e[2]:0)}},e.exports=s},{"./Dispatch":7,"./Node":10,"./Size":12}],12:[function(t,e,i){"use strict";function s(){this._size=new Float32Array(3)}s.RELATIVE=0,s.ABSOLUTE=1,s.RENDER=2,s.DEFAULT=s.RELATIVE,s.prototype.fromSpecWithParent=function(t,e,i){for(var r,n,o=e.getValue().spec,a=e.getComponents(),h=o.size.sizeMode,u=!1,l=a.length,c=0;3>c;c++){switch(h[c]){case s.RELATIVE:r=i[c],i[c]=t[c]*o.size.proportional[c]+o.size.differential[c];break;case s.ABSOLUTE:r=i[c],i[c]=o.size.absolute[c];break;case s.RENDER:var p,d;for(n=0;l>n;n++)d=a[n],d&&d.getRenderSize&&(p=d.getRenderSize()[c],r=i[c],i[c]=i[c]<p||0===i[c]?p:i[c])}u=u||r!==i[c]}return u},e.exports=s},{}],13:[function(t,e,i){"use strict";function s(){this._matrix=new Float32Array(16)}s.prototype.get=function(){return this._matrix},s.prototype.fromSpecWithParent=function(t,e,i,s,r){r=r?r:this._matrix;var n=r[0],o=r[1],a=r[2],h=r[4],u=r[5],l=r[6],c=r[8],p=r[9],d=r[10],f=r[12],m=r[13],g=r[14],_=t[0],v=t[1],y=t[2],b=t[4],w=t[5],x=t[6],T=t[8],C=t[9],E=t[10],S=t[12],R=t[13],M=t[14],A=e.vectors.position[0],z=e.vectors.position[1],O=e.vectors.position[2],U=e.vectors.rotation[0],L=e.vectors.rotation[1],k=e.vectors.rotation[2],I=e.vectors.rotation[3],D=e.vectors.scale[0],P=e.vectors.scale[1],G=e.vectors.scale[2],F=e.offsets.align[0]*s[0],N=e.offsets.align[1]*s[1],q=e.offsets.align[2]*s[2],V=e.offsets.mountPoint[0]*i[0],B=e.offsets.mountPoint[1]*i[1],H=e.offsets.mountPoint[2]*i[2],W=e.offsets.origin[0]*i[0],j=e.offsets.origin[1]*i[1],Q=e.offsets.origin[2]*i[2],X=I*U,K=I*L,Y=I*k,J=U*U,Z=L*L,$=k*k,tt=U*L,et=U*k,it=L*k,st=(1-2*(Z+$))*D,rt=2*(tt+Y)*D,nt=2*(et-K)*D,ot=2*(tt-Y)*P,at=(1-2*(J+$))*P,ht=2*(it+X)*P,ut=2*(et+K)*G,lt=2*(it-X)*G,ct=(1-2*(J+Z))*G,pt=F+A-V+W-(st*W+ot*j+ut*Q),dt=N+z-B+j-(rt*W+at*j+lt*Q),ft=q+O-H+Q-(nt*W+ht*j+ct*Q);return r[0]=_*st+b*rt+T*nt,r[1]=v*st+w*rt+C*nt,r[2]=y*st+x*rt+E*nt,r[3]=0,r[4]=_*ot+b*at+T*ht,r[5]=v*ot+w*at+C*ht,r[6]=y*ot+x*at+E*ht,r[7]=0,r[8]=_*ut+b*lt+T*ct,r[9]=v*ut+w*lt+C*ct,r[10]=y*ut+x*lt+E*ct,r[11]=0,r[12]=_*pt+b*dt+T*ft+S,r[13]=v*pt+w*dt+C*ft+R,r[14]=y*pt+x*dt+E*ft+M,r[15]=1,n!==r[0]||o!==r[1]||a!==r[2]||h!==r[4]||u!==r[5]||l!==r[6]||c!==r[8]||p!==r[9]||d!==r[10]||f!==r[12]||m!==r[13]||g!==r[14]},e.exports=s},{}],14:[function(t,e,i){"use strict";function s(t,e){if(!t)throw new Error("DOMElement must be instantiated on a node");if(this._node=t,this._requestingUpdate=!1,this._renderSized=!1,this._requestRenderSize=!1,this._changeQueue=[],this._UIEvents=t.getUIEvents().slice(0),this._classes=["famous-dom-element"],this._requestingEventListeners=[],this._styles={},this.setProperty("display",t.isShown()?"none":"block"),this.onOpacityChange(t.getOpacity()),this._attributes={},this._content="",this._tagName=e&&e.tagName?e.tagName:"div",this._id=t.addComponent(this),this._renderSize=[0,0,0],this._callbacks=new r,e){var i,s;if(e.classes)for(i=0;i<e.classes.length;i++)this.addClass(e.classes[i]);if(e.attributes)for(s in e.attributes)this.setAttribute(s,e.attributes[s]);if(e.properties)for(s in e.properties)this.setProperty(s,e.properties[s]);e.id&&this.setId(e.id),e.content&&this.setContent(e.content),e.cutout===!1&&this.setCutoutState(e.cutout)}}var r=t("../utilities/CallbackStore"),n=2;s.prototype.getValue=function(){return{classes:this._classes,styles:this._styles,attributes:this._attributes,content:this._content,id:this._attributes.id,tagName:this._tagName}},s.prototype.onUpdate=function(){var t=this._node,e=this._changeQueue,i=e.length;if(i&&t){for(t.sendDrawCommand("WITH"),t.sendDrawCommand(t.getLocation());i--;)t.sendDrawCommand(e.shift());this._requestRenderSize&&(t.sendDrawCommand("DOM_RENDER_SIZE"),t.sendDrawCommand(t.getLocation()),this._requestRenderSize=!1)}this._requestingUpdate=!1},s.prototype.onMount=function(t,e){this._node=t,this._id=e,this._UIEvents=t.getUIEvents().slice(0),this.draw(),this.setAttribute("data-fa-path",t.getLocation())},s.prototype.onDismount=function(){this.setProperty("display","none"),this.setAttribute("data-fa-path",""),this._initialized=!1},s.prototype.onShow=function(){this.setProperty("display","block")},s.prototype.onHide=function(){this.setProperty("display","none")},s.prototype.setCutoutState=function(t){this._changeQueue.push("GL_CUTOUT_STATE",t),this._initialized&&this._requestUpdate()},s.prototype.onTransformChange=function(t){this._changeQueue.push("CHANGE_TRANSFORM");for(var e=0,i=t.length;i>e;e++)this._changeQueue.push(t[e]);this.onUpdate()},s.prototype.onSizeChange=function(t){var e=this._node.getSizeMode(),i=e[0]!==n,s=e[1]!==n;return this._initialized&&this._changeQueue.push("CHANGE_SIZE",i?t[0]:i,s?t[1]:s),this._requestingUpdate||this._requestUpdate(),this},s.prototype.onOpacityChange=function(t){return this.setProperty("opacity",t)},s.prototype.onAddUIEvent=function(t){return-1===this._UIEvents.indexOf(t)?(this._subscribe(t),this._UIEvents.push(t)):this._inDraw&&this._subscribe(t),this},s.prototype._subscribe=function(t){this._initialized&&this._changeQueue.push("SUBSCRIBE",t,!0),this._requestingUpdate||this._requestUpdate()},s.prototype.onSizeModeChange=function(t,e,i){(t===n||e===n||i===n)&&(this._renderSized=!0,this._requestRenderSize=!0),this.onSizeChange(this._node.getSize())},s.prototype.getRenderSize=function(){return this._renderSize},s.prototype._requestUpdate=function(){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0)},s.prototype.init=function(){this._changeQueue.push("INIT_DOM",this._tagName),this._initialized=!0,this.onTransformChange(this._node.getTransform()),this.onSizeChange(this._node.getSize()),this._requestingUpdate||this._requestUpdate()},s.prototype.setId=function(t){return this.setAttribute("id",t),this},s.prototype.addClass=function(t){return this._classes.indexOf(t)<0?(this._initialized&&this._changeQueue.push("ADD_CLASS",t),this._classes.push(t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0),this):(this._inDraw&&(this._initialized&&this._changeQueue.push("ADD_CLASS",t),this._requestingUpdate||this._requestUpdate()),this)},s.prototype.removeClass=function(t){var e=this._classes.indexOf(t);return 0>e?this:(this._changeQueue.push("REMOVE_CLASS",t),this._classes.splice(e,1),this._requestingUpdate||this._requestUpdate(),this)},s.prototype.hasClass=function(t){return-1!==this._classes.indexOf(t)},s.prototype.setAttribute=function(t,e){return(this._attributes[t]!==e||this._inDraw)&&(this._attributes[t]=e,this._initialized&&this._changeQueue.push("CHANGE_ATTRIBUTE",t,e),this._requestUpdate||this._requestUpdate()),this},s.prototype.setProperty=function(t,e){return(this._styles[t]!==e||this._inDraw)&&(this._styles[t]=e,this._initialized&&this._changeQueue.push("CHANGE_PROPERTY",t,e),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},s.prototype.setContent=function(t){return(this._content!==t||this._inDraw)&&(this._content=t,this._initialized&&this._changeQueue.push("CHANGE_CONTENT",t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},s.prototype.on=function(t,e){return this._callbacks.on(t,e)},s.prototype.onReceive=function(t,e){"resize"===t&&(this._renderSize[0]=e.val[0],this._renderSize[1]=e.val[1],this._requestingUpdate||this._requestUpdate()),this._callbacks.trigger(t,e)},s.prototype.draw=function(){var t,e,i;for(this._inDraw=!0,this.init(),e=0,i=this._classes.length;i>e;e++)this.addClass(this._classes[e]);this._content&&this.setContent(this._content);for(t in this._styles)this._styles[t]&&this.setProperty(t,this._styles[t]);for(t in this._attributes)this._attributes[t]&&this.setAttribute(t,this._attributes[t]);for(e=0,i=this._UIEvents.length;i>e;e++)this.onAddUIEvent(this._UIEvents[e]);this._inDraw=!1},e.exports=s},{"../utilities/CallbackStore":41}],15:[function(t,e,i){"use strict";function s(t,e,i){var s=this;t.classList.add("famous-dom-renderer"),u=u||a("transform"),this._compositor=i,this._target=null,this._parent=null,this._path=null,this._children=[],this._root=new n(t,e),this._boundTriggerEvent=function(t){return s._triggerEvent(t)},this._selector=e,this._elements={},this._elements[e]=this._root,this.perspectiveTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._VPtransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._size=[null,null]}function r(t){for(var e=[],i=t.target;i!==document.body;)e.push(i),i=i.parentNode;return e}var n=t("./ElementCache"),o=t("./Math"),a=t("../utilities/vendorPrefix"),h=t("./events/EventMap"),u=null;s.prototype.subscribe=function(t,e){if(this._assertTargetLoaded(),this._target.preventDefault[t]=e,this._target.subscribe[t]=!0,!this._target.listeners[t]&&!this._root.listeners[t]){var i=h[t][1]?this._root:this._target;i.listeners[t]=this._boundTriggerEvent,i.element.addEventListener(t,this._boundTriggerEvent)}},s.prototype._triggerEvent=function(t){for(var e=t.path?t.path:r(t),i=0;i<e.length;i++)if(e[i].dataset){var s=e[i].dataset.faPath;if(s&&this._elements[s]&&this._elements[s].subscribe[t.type]){t.stopPropagation(),this._elements[s].preventDefault[t.type]&&t.preventDefault();var n=h[t.type][0];this._compositor.sendEvent(s,t.type,new n(t));break}}},s.prototype.getSizeOf=function(t){var e=this._elements[t];if(!e)return null;var i={val:e.size};return this._compositor.sendEvent(t,"resize",i),i},s.prototype.getSize=function(){return this._size[0]=this._root.element.offsetWidth,this._size[1]=this._root.element.offsetHeight,this._size},s.prototype._getSize=s.prototype.getSize,s.prototype.draw=function(t){t.perspectiveDirty&&(this.perspectiveDirty=!0,this.perspectiveTransform[0]=t.perspectiveTransform[0],this.perspectiveTransform[1]=t.perspectiveTransform[1],this.perspectiveTransform[2]=t.perspectiveTransform[2],this.perspectiveTransform[3]=t.perspectiveTransform[3],this.perspectiveTransform[4]=t.perspectiveTransform[4],this.perspectiveTransform[5]=t.perspectiveTransform[5],this.perspectiveTransform[6]=t.perspectiveTransform[6],this.perspectiveTransform[7]=t.perspectiveTransform[7],this.perspectiveTransform[8]=t.perspectiveTransform[8],this.perspectiveTransform[9]=t.perspectiveTransform[9],this.perspectiveTransform[10]=t.perspectiveTransform[10],this.perspectiveTransform[11]=t.perspectiveTransform[11],this.perspectiveTransform[12]=t.perspectiveTransform[12],this.perspectiveTransform[13]=t.perspectiveTransform[13],this.perspectiveTransform[14]=t.perspectiveTransform[14],this.perspectiveTransform[15]=t.perspectiveTransform[15]),(t.viewDirty||t.perspectiveDirty)&&(o.multiply(this._VPtransform,this.perspectiveTransform,t.viewTransform),this._root.element.style[u]=this._stringifyMatrix(this._VPtransform))},s.prototype._assertPathLoaded=function(){if(!this._path)throw new Error("path not loaded")},s.prototype._assertParentLoaded=function(){if(!this._parent)throw new Error("parent not loaded")},s.prototype._assertChildrenLoaded=function(){if(!this._children)throw new Error("children not loaded")},s.prototype._assertTargetLoaded=function(){if(!this._target)throw new Error("No target loaded")},s.prototype.findParent=function(){this._assertPathLoaded();for(var t,e=this._path;!t&&e.length;)e=e.substring(0,e.lastIndexOf("/")),t=this._elements[e];return this._parent=t,t},s.prototype.findChildren=function(t){this._assertPathLoaded();var e,i=this._path+"/",s=Object.keys(this._elements),r=0;for(t=t?t:this._children,this._children.length=0;r<s.length;)-1===s[r].indexOf(i)||s[r]===i?s.splice(r,1):r++;var n,o=0;for(r=0;r<s.length;r++)for(n=s[r],o=0;o<s.length;o++)r!==o&&-1!==s[o].indexOf(n)&&(s.splice(o,1),r--);for(r=0,e=s.length;e>r;r++)t[r]=this._elements[s[r]];return t},s.prototype.findTarget=function(){return this._target=this._elements[this._path],this._target},s.prototype.loadPath=function(t){return this._path=t,this._path},s.prototype.insertEl=function(t){if(!this._target||this._target.element.tagName.toLowerCase()!==t.toLowerCase()){this.findParent(),this.findChildren(),this._assertParentLoaded(),this._assertChildrenLoaded(),this._target&&this._parent.element.removeChild(this._target.element),this._target=new n(document.createElement(t),this._path),this._parent.element.appendChild(this._target.element),this._elements[this._path]=this._target;for(var e=0,i=this._children.length;i>e;e++)this._target.element.appendChild(this._children[e].element)}},s.prototype.setProperty=function(t,e){this._assertTargetLoaded(),this._target.element.style[t]=e},s.prototype.setSize=function(t,e){this._assertTargetLoaded(),this.setWidth(t),this.setHeight(e)},s.prototype.setWidth=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitWidth=!0,e&&(e.style.width=""),t=e?e.offsetWidth:0,this._target.element.style.width=t+"px"):(this._target.explicitWidth=!1,e&&(e.style.width=t+"px"),this._target.element.style.width=t+"px"),this._target.size[0]=t},s.prototype.setHeight=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitHeight=!0,e&&(e.style.height=""),t=e?e.offsetHeight:0,this._target.element.style.height=t+"px"):(this._target.explicitHeight=!1,e&&(e.style.height=t+"px"),this._target.element.style.height=t+"px"),this._target.size[1]=t},s.prototype.setAttribute=function(t,e){this._assertTargetLoaded(),this._target.element.setAttribute(t,e)},s.prototype.setContent=function(t){this._assertTargetLoaded(),this.findChildren(),this._target.content||(this._target.content=document.createElement("div"),this._target.content.classList.add("famous-dom-element-content"),this._target.element.insertBefore(this._target.content,this._target.element.firstChild)),this._target.content.innerHTML=t,this.setSize(this._target.explicitWidth?!1:this._target.size[0],this._target.explicitHeight?!1:this._target.size[1])},s.prototype.setMatrix=function(t){this._assertTargetLoaded(),this.findParent();var e,i,s=this._target.worldTransform,r=!1;if(t)for(e=0,i=16;i>e;e++)r=r?r:s[e]===t[e],s[e]=t[e];else r=!0;if(r){o.invert(this._target.invertedParent,this._parent.worldTransform),o.multiply(this._target.finalTransform,this._target.invertedParent,s);var n=this.findChildren([]),a=this._path,h=this._target;for(e=0,i=n.length;i>e;e++)this._target=n[e],this._path=this._target.path,this.setMatrix();this._path=a,this._target=h}this._target.element.style[u]=this._stringifyMatrix(this._target.finalTransform)},s.prototype.addClass=function(t){this._assertTargetLoaded(),this._target.element.classList.add(t)},s.prototype.removeClass=function(t){this._assertTargetLoaded(),this._target.element.classList.remove(t)},s.prototype._stringifyMatrix=function(t){var e="matrix3d(";return e+=t[0]<1e-6&&t[0]>-1e-6?"0,":t[0]+",",e+=t[1]<1e-6&&t[1]>-1e-6?"0,":t[1]+",",e+=t[2]<1e-6&&t[2]>-1e-6?"0,":t[2]+",",e+=t[3]<1e-6&&t[3]>-1e-6?"0,":t[3]+",",e+=t[4]<1e-6&&t[4]>-1e-6?"0,":t[4]+",",e+=t[5]<1e-6&&t[5]>-1e-6?"0,":t[5]+",",e+=t[6]<1e-6&&t[6]>-1e-6?"0,":t[6]+",",e+=t[7]<1e-6&&t[7]>-1e-6?"0,":t[7]+",",e+=t[8]<1e-6&&t[8]>-1e-6?"0,":t[8]+",",e+=t[9]<1e-6&&t[9]>-1e-6?"0,":t[9]+",",e+=t[10]<1e-6&&t[10]>-1e-6?"0,":t[10]+",",e+=t[11]<1e-6&&t[11]>-1e-6?"0,":t[11]+",",e+=t[12]<1e-6&&t[12]>-1e-6?"0,":t[12]+",",e+=t[13]<1e-6&&t[13]>-1e-6?"0,":t[13]+",",e+=t[14]<1e-6&&t[14]>-1e-6?"0,":t[14]+",",e+=t[15]+")"},e.exports=s},{"../utilities/vendorPrefix":46,"./ElementCache":16,"./Math":17,"./events/EventMap":20}],16:[function(t,e,i){"use strict";function s(t,e){this.element=t,this.path=e,this.content=null,this.size=new Int16Array(3),this.explicitHeight=!1,this.explicitWidth=!1,this.worldTransform=new Float32Array(r),this.invertedParent=new Float32Array(r),this.finalTransform=new Float32Array(r),this.postRenderSize=new Float32Array(2),this.listeners={},this.preventDefault={},this.subscribe={}}var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];e.exports=s},{}],17:[function(t,e,i){"use strict";function s(t,e){var i=e[0],s=e[1],r=e[2],n=e[3],o=e[4],a=e[5],h=e[6],u=e[7],l=e[8],c=e[9],p=e[10],d=e[11],f=e[12],m=e[13],g=e[14],_=e[15],v=i*a-s*o,y=i*h-r*o,b=i*u-n*o,w=s*h-r*a,x=s*u-n*a,T=r*u-n*h,C=l*m-c*f,E=l*g-p*f,S=l*_-d*f,R=c*g-p*m,M=c*_-d*m,A=p*_-d*g,z=v*A-y*M+b*R+w*S-x*E+T*C;return z?(z=1/z,t[0]=(a*A-h*M+u*R)*z,t[1]=(r*M-s*A-n*R)*z,t[2]=(m*T-g*x+_*w)*z,t[3]=(p*x-c*T-d*w)*z,t[4]=(h*S-o*A-u*E)*z,t[5]=(i*A-r*S+n*E)*z,t[6]=(g*b-f*T-_*y)*z,t[7]=(l*T-p*b+d*y)*z,t[8]=(o*M-a*S+u*C)*z,t[9]=(s*S-i*M-n*C)*z,t[10]=(f*x-m*b+_*v)*z,t[11]=(c*b-l*x-d*v)*z,t[12]=(a*E-o*R-h*C)*z,t[13]=(i*R-s*E+r*C)*z,t[14]=(m*y-f*w-g*v)*z,t[15]=(l*w-c*y+p*v)*z,t):null}function r(t,e,i){var s,r,n,o,a=e[0],h=e[1],u=e[2],l=e[3],c=e[4],p=e[5],d=e[6],f=e[7],m=e[8],g=e[9],_=e[10],v=e[11],y=e[12],b=e[13],w=e[14],x=e[15],T=i[0],C=i[1],E=i[2],S=i[3],R=i[4],M=i[5],A=i[6],z=i[7],O=i[8],U=i[9],L=i[10],k=i[11],I=i[12],D=i[13],P=i[14],G=i[15],F=!1;return s=T*a+C*c+E*m+S*y,r=T*h+C*p+E*g+S*b,n=T*u+C*d+E*_+S*w,o=T*l+C*f+E*v+S*x,F=F?F:s===t[0]||r===t[1]||n===t[2]||o===t[3],t[0]=s,t[1]=r,t[2]=n,t[3]=o,T=R,C=M,E=A,S=z,s=T*a+C*c+E*m+S*y,r=T*h+C*p+E*g+S*b,n=T*u+C*d+E*_+S*w,o=T*l+C*f+E*v+S*x,F=F?F:s===t[4]||r===t[5]||n===t[6]||o===t[7],t[4]=s,t[5]=r,t[6]=n,t[7]=o,T=O,C=U,E=L,S=k,s=T*a+C*c+E*m+S*y,r=T*h+C*p+E*g+S*b,n=T*u+C*d+E*_+S*w,o=T*l+C*f+E*v+S*x,F=F?F:s===t[8]||r===t[9]||n===t[10]||o===t[11],t[8]=s,t[9]=r,t[10]=n,t[11]=o,T=I,C=D,E=P,S=G,s=T*a+C*c+E*m+S*y,r=T*h+C*p+E*g+S*b,n=T*u+C*d+E*_+S*w,o=T*l+C*f+E*v+S*x,F=F?F:s===t[12]||r===t[13]||n===t[14]||o===t[15],t[12]=s,t[13]=r,t[14]=n,t[15]=o,t}e.exports={multiply:r,invert:s}},{}],18:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.data=t.data}var r=t("./UIEvent");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"CompositionEvent"},e.exports=s},{"./UIEvent":26}],19:[function(t,e,i){"use strict";function s(t){this.type=t.type,this.defaultPrevented=t.defaultPrevented,this.timeStamp=t.timeStamp;var e=t.target.constructor;(e===HTMLInputElement||e===HTMLTextAreaElement||e===HTMLSelectElement)&&(this.value=t.target.value)}s.prototype.toString=function(){return"Event"},e.exports=s},{}],20:[function(t,e,i){"use strict";var s=t("./CompositionEvent"),r=t("./Event"),n=t("./FocusEvent"),o=t("./InputEvent"),a=t("./KeyboardEvent"),h=t("./MouseEvent"),u=t("./TouchEvent"),l=t("./UIEvent"),c=t("./WheelEvent"),p={change:[r,!0],submit:[r,!0],abort:[r,!1],beforeinput:[o,!0],blur:[n,!1],click:[h,!0],compositionend:[s,!0],compositionstart:[s,!0],compositionupdate:[s,!0],dblclick:[h,!0],focus:[n,!1],focusin:[n,!0],focusout:[n,!0],input:[o,!0],keydown:[a,!0],keyup:[a,!0],load:[r,!1],mousedown:[h,!0],mouseenter:[h,!1],mouseleave:[h,!1],mousemove:[h,!1],mouseout:[h,!0],mouseover:[h,!0],mouseup:[h,!0],resize:[l,!1],scroll:[l,!1],select:[r,!0],unload:[r,!1],wheel:[c,!0],touchcancel:[u,!0],touchend:[u,!0],touchmove:[u,!0],touchstart:[u,!0]};e.exports=p},{"./CompositionEvent":18,"./Event":19,"./FocusEvent":21,"./InputEvent":22,"./KeyboardEvent":23,"./MouseEvent":24,"./TouchEvent":25,"./UIEvent":26,"./WheelEvent":27}],21:[function(t,e,i){"use strict";function s(t){r.call(this,t)}var r=t("./UIEvent");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"FocusEvent"},e.exports=s},{"./UIEvent":26}],22:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.inputType=t.inputType,this.data=t.data,this.isComposing=t.isComposing,this.targetRange=t.targetRange}var r=t("./UIEvent");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"InputEvent"},e.exports=s},{"./UIEvent":26}],23:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.DOM_KEY_LOCATION_STANDARD=0,this.DOM_KEY_LOCATION_LEFT=1,this.DOM_KEY_LOCATION_RIGHT=2,this.DOM_KEY_LOCATION_NUMPAD=3,this.key=t.key,this.code=t.code,this.location=t.location,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.repeat=t.repeat,this.isComposing=t.isComposing,this.keyCode=t.keyCode}var r=t("./UIEvent");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"KeyboardEvent"},e.exports=s},{"./UIEvent":26}],24:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.button=t.button,this.buttons=t.buttons,this.pageX=t.pageX,this.pageY=t.pageY,this.x=t.x,this.y=t.y,this.offsetX=t.offsetX,this.offsetY=t.offsetY}var r=t("./UIEvent");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"MouseEvent"},e.exports=s},{"./UIEvent":26}],25:[function(t,e,i){"use strict";function s(t){this.identifier=t.identifier,this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY}function r(t){if(!t)return a;for(var e=[],i=0;i<t.length;i++)e[i]=new s(t[i]);return e}function n(t){o.call(this,t),this.touches=r(t.touches),this.targetTouches=r(t.targetTouches),this.changedTouches=r(t.changedTouches),this.altKey=t.altKey,this.metaKey=t.metaKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey}var o=t("./UIEvent"),a=[];n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return"TouchEvent"},e.exports=n},{"./UIEvent":26}],26:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.detail=t.detail}var r=t("./Event");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"UIEvent"},e.exports=s},{"./Event":19}],27:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2,this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.deltaMode=t.deltaMode}var r=t("./MouseEvent");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"WheelEvent"},e.exports=s},{"./MouseEvent":24}],28:[function(t,e,i){"use strict";var s=function(t,e){t instanceof Array||t instanceof Float32Array?(this.x=t[0]||0,this.y=t[1]||0):(this.x=t||0,this.y=e||0)};s.prototype.set=function(t,e){return null!=t&&(this.x=t),null!=e&&(this.y=e),this},s.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},s.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},s.prototype.scale=function(t){return t instanceof s?(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=t),this},s.prototype.rotate=function(t){var e=this.x,i=this.y,s=Math.cos(t),r=Math.sin(t);return this.x=e*s-i*r,this.y=e*r+i*s,this},s.prototype.dot=function(t){return this.x*t.x+this.y*t.y},s.prototype.cross=function(t){return this.x*t.y-this.y*t.x},s.prototype.invert=function(){return this.x*=-1,this.y*=-1,this},s.prototype.map=function(t){return this.x=t(this.x),this.y=t(this.y),this},s.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},s.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},s.prototype.clear=function(){return this.x=0,this.y=0,this},s.prototype.isZero=function(){return 0!==this.x||0!==this.y?!1:!0},s.prototype.toArray=function(){return[this.x,this.y]},s.normalize=function(t,e){var i=t.x,s=t.y,r=Math.sqrt(i*i+s*s)||1;return r=1/r,e.x=t.x*r,e.y=t.y*r,e},s.clone=function(t){return new s(t.x,t.y)},s.add=function(t,e,i){return i.x=t.x+e.x,i.y=t.y+e.y,i},s.subtract=function(t,e,i){return i.x=t.x-e.x,i.y=t.y-e.y,i},s.scale=function(t,e,i){return i.x=t.x*e,i.y=t.y*e,i},s.dot=function(t,e){return t.x*e.x+t.y*e.y},s.cross=function(t,e){return t.x*e.y-t.y*e.x},e.exports=s},{}],29:[function(t,e,i){"use strict";var s=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0};s.prototype.set=function(t,e,i){return null!=t&&(this.x=t),null!=e&&(this.y=e),null!=i&&(this.z=i),this},s.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},s.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},s.prototype.rotateX=function(t){var e=this.y,i=this.z,s=Math.cos(t),r=Math.sin(t);return this.y=e*s-i*r,this.z=e*r+i*s,this},s.prototype.rotateY=function(t){var e=this.x,i=this.z,s=Math.cos(t),r=Math.sin(t);return this.x=i*r+e*s,this.z=i*s-e*r,this},s.prototype.rotateZ=function(t){var e=this.x,i=this.y,s=Math.cos(t),r=Math.sin(t);return this.x=e*s-i*r,this.y=e*r+i*s,this},s.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},s.prototype.cross=function(t){var e=this.x,i=this.y,s=this.z,r=t.x,n=t.y,o=t.z;return this.x=i*o-s*n,this.y=s*r-e*o,this.z=e*n-i*r,this},s.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},s.prototype.invert=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},s.prototype.map=function(t){return this.x=t(this.x),this.y=t(this.y),this.z=t(this.z),this},s.prototype.length=function(){var t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)},s.prototype.lengthSq=function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},s.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},s.prototype.clear=function(){return this.x=0,this.y=0,this.z=0,this},s.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},s.prototype.toArray=function(){return[this.x,this.y,this.z]},s.prototype.normalize=function(){var t=this.x,e=this.y,i=this.z,s=Math.sqrt(t*t+e*e+i*i)||1;return s=1/s,this.x*=s,this.y*=s,this.z*=s,this},s.prototype.applyRotation=function(t){var e=t.w,i=-t.x,s=-t.y,r=-t.z,n=this.x,o=this.y,a=this.z,h=-i*n-s*o-r*a,u=n*e+o*r-s*a,l=o*e+i*a-n*r,c=a*e+n*s-i*o,p=e,d=-i,f=-s,m=-r;return this.x=u*p+d*h+f*c-l*m,this.y=l*p+f*h+u*m-d*c,this.z=c*p+m*h+d*l-u*f,this},s.prototype.applyMatrix=function(t){var e=t.get(),i=this.x,s=this.y,r=this.z;return this.x=e[0]*i+e[1]*s+e[2]*r,this.y=e[3]*i+e[4]*s+e[5]*r,this.z=e[6]*i+e[7]*s+e[8]*r,this},s.normalize=function(t,e){var i=t.x,s=t.y,r=t.z,n=Math.sqrt(i*i+s*s+r*r)||1;return n=1/n,e.x=i*n,e.y=s*n,e.z=r*n,e},s.applyRotation=function(t,e,i){var s=e.w,r=-e.x,n=-e.y,o=-e.z,a=t.x,h=t.y,u=t.z,l=-r*a-n*h-o*u,c=a*s+h*o-n*u,p=h*s+r*u-a*o,d=u*s+a*n-r*h,f=s,m=-r,g=-n,_=-o;return i.x=c*f+m*l+g*d-p*_,i.y=p*f+g*l+c*_-m*d,i.z=d*f+_*l+m*p-c*g,i},s.clone=function(t){return new s(t.x,t.y,t.z)},s.add=function(t,e,i){return i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i},s.subtract=function(t,e,i){return i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i},s.scale=function(t,e,i){return i.x=t.x*e,i.y=t.y*e,i.z=t.z*e,i},s.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},s.cross=function(t,e,i){var s=t.x,r=t.y,n=t.z,o=e.x,a=e.y,h=e.z;return i.x=r*h-n*a,i.y=n*o-s*h,i.z=s*a-r*o,i},s.project=function(t,e,i){var s=t.x,r=t.y,n=t.z,o=e.x,a=e.y,h=e.z,u=s*o+r*a+n*h;return u/=o*o+a*a+h*h,i.x=o*u,i.y=a*u,i.z=h*u,i},e.exports=s},{}],30:[function(t,e,i){function s(){throw new Error("You should bundle your code using `glslify` as a transform.")}e.exports=s},{}],31:[function(t,e,i){function s(t,e,i,s){return{vertex:t,fragment:e,uniforms:i,attributes:s}}e.exports=s},{}],32:[function(t,e,i){"use strict";var s,r,n=0,o=["ms","moz","webkit","o"];if("object"==typeof window){s=window.requestAnimationFrame,r=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(var a=0;a<o.length&&!s;++a)s=window[o[a]+"RequestAnimationFrame"],r=window[o[a]+"CancelRequestAnimationFrame"]||window[o[a]+"CancelAnimationFrame"];s&&!r&&(s=null)}if(!s){var h=Date.now?Date.now:function(){return(new Date).getTime()};s=function(t){var e=h(),i=Math.max(0,16-(e-n)),s=setTimeout(function(){t(e+i)},i);return n=e+i,s},r=function(t){clearTimeout(t)}}var u={requestAnimationFrame:s,cancelAnimationFrame:r};e.exports=u},{}],33:[function(t,e,i){"use strict";e.exports={requestAnimationFrame:t("./animationFrame").requestAnimationFrame,cancelAnimationFrame:t("./animationFrame").cancelAnimationFrame}},{"./animationFrame":32}],34:[function(t,e,i){"use strict";function s(){var t=this;this._updates=[],this._looper=function(e){t.loop(e)},this._time=0,this._stoppedAt=0,this._sleep=0,this._startOnVisibilityChange=!0,this._rAF=null,this._sleepDiff=!0,this.start(),a&&document.addEventListener(u,function(){t._onVisibilityChange()})}var r=t("../polyfills"),n=r.requestAnimationFrame,o=r.cancelAnimationFrame,a="undefined"!=typeof document;if(a){var h,u;"undefined"!=typeof document.hidden?(h="hidden",u="visibilitychange"):"undefined"!=typeof document.mozHidden?(h="mozHidden",u="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(h="msHidden",u="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(h="webkitHidden",u="webkitvisibilitychange")}s.prototype._onVisibilityChange=function(){document[h]?this._onUnfocus():this._onFocus()},s.prototype._onFocus=function(){this._startOnVisibilityChange&&this._start()},s.prototype._onUnfocus=function(){this._stop()},s.prototype.start=function(){return this._running||(this._startOnVisibilityChange=!0,this._start()),this},s.prototype._start=function(){this._running=!0,this._sleepDiff=!0,this._rAF=n(this._looper)},s.prototype.stop=function(){return this._running&&(this._startOnVisibilityChange=!1,this._stop()),this},s.prototype._stop=function(){this._running=!1,this._stoppedAt=this._time,o(this._rAF)},s.prototype.isRunning=function(){return this._running},s.prototype.step=function(t){this._time=t,this._sleepDiff&&(this._sleep+=t-this._stoppedAt,this._sleepDiff=!1);for(var e=t-this._sleep,i=0,s=this._updates.length;s>i;i++)this._updates[i].update(e);
return this},s.prototype.loop=function(t){return this.step(t),this._rAF=n(this._looper),this},s.prototype.update=function(t){return-1===this._updates.indexOf(t)&&this._updates.push(t),this},s.prototype.noLongerUpdate=function(t){var e=this._updates.indexOf(t);return e>-1&&this._updates.splice(e,1),this},e.exports=s},{"../polyfills":33}],35:[function(t,e,i){"use strict";function s(){n(),this._contexts={},this._outCommands=[],this._inCommands=[],this._time=null,this._resized=!1;var t=this;window.addEventListener("resize",function(){t._resized=!0})}var r=t("./Context"),n=t("./inject-css");s.prototype.getTime=function(){return this._time},s.prototype.sendEvent=function(t,e,i){this._outCommands.push("WITH",t,"TRIGGER",e,i)},s.prototype.sendResize=function(t,e){this.sendEvent(t,"CONTEXT_RESIZE",e)},s.prototype.handleWith=function(t,e){var i=e[t],s=i.split("/"),r=this.getOrSetContext(s.shift());return r.receive(i,e,t)},s.prototype.getOrSetContext=function(t){if(this._contexts[t])return this._contexts[t];var e=new r(t,this);return this._contexts[t]=e,e},s.prototype.giveSizeFor=function(t,e){var i=e[t],s=this.getOrSetContext(i).getRootSize();this.sendResize(i,s)},s.prototype.drawCommands=function(){for(var t=this._inCommands,e=0,i=t[e];i;){switch(i){case"TIME":this._time=t[++e];break;case"WITH":e=this.handleWith(++e,t);break;case"NEED_SIZE_FOR":this.giveSizeFor(++e,t)}i=t[++e]}for(var s in this._contexts)this._contexts[s].draw();return this._resized&&this.updateSize(),this._outCommands},s.prototype.updateSize=function(){for(var t in this._contexts)this._contexts[t].updateSize()},s.prototype.receiveCommands=function(t){for(var e=t.length,i=0;e>i;i++)this._inCommands.push(t[i])},s.prototype.clearCommands=function(){this._inCommands.length=0,this._outCommands.length=0,this._resized=!1},e.exports=s},{"./Context":36,"./inject-css":38}],36:[function(t,e,i){"use strict";function s(t,e){this._compositor=e,this._rootEl=document.querySelector(t),this._selector=t;var i=document.createElement("div");this._rootEl.appendChild(i),this.DOMRenderer=new o(i,t,e),this.WebGLRenderer=null,this.canvas=null,this._renderState={projectionType:n.ORTHOGRAPHIC_PROJECTION,perspectiveTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewDirty:!1,perspectiveDirty:!1},this._size=[],this._children={},this._elementHash={},this._meshTransform=[],this._meshSize=[0,0,0]}var r=t("../webgl-renderers/WebGLRenderer"),n=t("../components/Camera"),o=t("../dom-renderers/DOMRenderer");s.prototype.updateSize=function(){var t=this.DOMRenderer.getSize();return this._compositor.sendResize(this._selector,t),this.canvas&&this.WebGLRenderer&&this.WebGLRenderer.updateSize(t),this},s.prototype.draw=function(){this.DOMRenderer.draw(this._renderState),this.WebGLRenderer&&this.WebGLRenderer.draw(this._renderState),this._renderState.perspectiveDirty&&(this._renderState.perspectiveDirty=!1),this._renderState.viewDirty&&(this._renderState.viewDirty=!1)},s.prototype.getRootSize=function(){return this.DOMRenderer.getSize()},s.prototype.initWebGL=function(){this.canvas=document.createElement("canvas"),this._rootEl.appendChild(this.canvas),this.WebGLRenderer=new r(this.canvas,this._compositor),this.updateSize()},s.prototype.receive=function(t,e,i){var s=i,r=e[++s];for(this.DOMRenderer.loadPath(t),this.DOMRenderer.findTarget();r;){switch(r){case"INIT_DOM":this.DOMRenderer.insertEl(e[++s]);break;case"DOM_RENDER_SIZE":this.DOMRenderer.getSizeOf(e[++s]);break;case"CHANGE_TRANSFORM":for(var o=0;16>o;o++)this._meshTransform[o]=e[++s];this.DOMRenderer.setMatrix(this._meshTransform),this.WebGLRenderer&&this.WebGLRenderer.setCutoutUniform(t,"u_transform",this._meshTransform);break;case"CHANGE_SIZE":var a=e[++s],h=e[++s];this.DOMRenderer.setSize(a,h),this.WebGLRenderer&&(this._meshSize[0]=a,this._meshSize[1]=h,this.WebGLRenderer.setCutoutUniform(t,"u_size",this._meshSize));break;case"CHANGE_PROPERTY":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.setProperty(e[++s],e[++s]);break;case"CHANGE_CONTENT":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.setContent(e[++s]);break;case"CHANGE_ATTRIBUTE":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.setAttribute(e[++s],e[++s]);break;case"ADD_CLASS":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.addClass(e[++s]);break;case"REMOVE_CLASS":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.removeClass(e[++s]);break;case"SUBSCRIBE":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.subscribe(e[++s],e[++s]);break;case"GL_SET_DRAW_OPTIONS":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setMeshOptions(t,e[++s]);break;case"GL_AMBIENT_LIGHT":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setAmbientLightColor(t,e[++s],e[++s],e[++s]);break;case"GL_LIGHT_POSITION":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setLightPosition(t,e[++s],e[++s],e[++s]);break;case"GL_LIGHT_COLOR":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setLightColor(t,e[++s],e[++s],e[++s]);break;case"MATERIAL_INPUT":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.handleMaterialInput(t,e[++s],e[++s]);break;case"GL_SET_GEOMETRY":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setGeometry(t,e[++s],e[++s],e[++s]);break;case"GL_UNIFORMS":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setMeshUniform(t,e[++s],e[++s]);break;case"GL_BUFFER_DATA":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.bufferData(t,e[++s],e[++s],e[++s],e[++s],e[++s]);break;case"GL_CUTOUT_STATE":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setCutoutState(t,e[++s]);break;case"GL_MESH_VISIBILITY":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setMeshVisibility(t,e[++s]);break;case"GL_REMOVE_MESH":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.removeMesh(t);break;case"PINHOLE_PROJECTION":this._renderState.projectionType=n.PINHOLE_PROJECTION,this._renderState.perspectiveTransform[11]=-1/e[++s],this._renderState.perspectiveDirty=!0;break;case"ORTHOGRAPHIC_PROJECTION":this._renderState.projectionType=n.ORTHOGRAPHIC_PROJECTION,this._renderState.perspectiveTransform[11]=0,this._renderState.perspectiveDirty=!0;break;case"CHANGE_VIEW_TRANSFORM":this._renderState.viewTransform[0]=e[++s],this._renderState.viewTransform[1]=e[++s],this._renderState.viewTransform[2]=e[++s],this._renderState.viewTransform[3]=e[++s],this._renderState.viewTransform[4]=e[++s],this._renderState.viewTransform[5]=e[++s],this._renderState.viewTransform[6]=e[++s],this._renderState.viewTransform[7]=e[++s],this._renderState.viewTransform[8]=e[++s],this._renderState.viewTransform[9]=e[++s],this._renderState.viewTransform[10]=e[++s],this._renderState.viewTransform[11]=e[++s],this._renderState.viewTransform[12]=e[++s],this._renderState.viewTransform[13]=e[++s],this._renderState.viewTransform[14]=e[++s],this._renderState.viewTransform[15]=e[++s],this._renderState.viewDirty=!0;break;case"WITH":return s-1}r=e[++s]}return s},e.exports=s},{"../components/Camera":1,"../dom-renderers/DOMRenderer":15,"../webgl-renderers/WebGLRenderer":75}],37:[function(t,e,i){"use strict";function s(t,e,i){this._thread=t,this._compositor=e,this._renderLoop=i,this._renderLoop.update(this);var s=this;this._thread.onmessage=function(t){var e=t.data?t.data:t;if("ENGINE"===e[0])switch(e[1]){case"START":s._renderLoop.start();break;case"STOP":s._renderLoop.stop();break;default:console.error('Unknown ENGINE command "'+e[1]+'"')}else s._compositor.receiveCommands(e)},this._thread.onerror=function(t){console.error(t)}}s.prototype.getThread=function(){return this._thread},s.prototype.getCompositor=function(){return this._compositor},s.prototype.getEngine=function(){return this._renderLoop},s.prototype.update=function(t){this._thread.postMessage(["FRAME",t]);var e=this._compositor.drawCommands();this._thread.postMessage(e),this._compositor.clearCommands()},e.exports=s},{}],38:[function(t,e,i){"use strict";function s(){if(!n)if(n=!0,document.createStyleSheet){var t=document.createStyleSheet();t.cssText=r}else{var e=document.getElementsByTagName("head")[0],i=document.createElement("style");i.styleSheet?i.styleSheet.cssText=r:i.appendChild(document.createTextNode(r)),(e?e:document.documentElement).appendChild(i)}}var r=".famous-dom-renderer {width:100%;height:100%;transform-style:preserve-3d;-webkit-transform-style:preserve-3d;}.famous-dom-element {-webkit-transform-origin:0% 0%;transform-origin:0% 0%;-webkit-backface-visibility:visible;backface-visibility:visible;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-tap-highlight-color:transparent;pointer-events:auto;z-index:1;}.famous-dom-element-content,.famous-dom-element {position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;}.famous-webgl-renderer {-webkit-transform:translateZ(1000000px);transform:translateZ(1000000px);pointer-events:none;position:absolute;z-index:1;top:0;width:100%;height:100%;}",n="undefined"==typeof document;e.exports=s},{}],39:[function(t,e,i){"use strict";var s={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t},inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,i=0,s=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},outElastic:function(t){var e=1.70158,i=0,s=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/s),s*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},inOutElastic:function(t){var e=1.70158,i=0,s=1;return 0===t?0:2===(t/=.5)?1:(i||(i=.3*1.5),e=i/(2*Math.PI)*Math.asin(1/s),1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)*.5+1)},inBack:function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e){return void 0===e&&(e=1.70158),(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-s.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*s.inBounce(2*t):.5*s.outBounce(2*t-1)+.5},flat:function(){return 0}};e.exports=s},{}],40:[function(t,e,i){"use strict";function s(t){this._queue=[],this._from=null,this._state=null,this._startedAt=null,this._pausedAt=null,null!=t&&this.from(t)}var r=t("./Curves"),n=t("../core/FamousEngine");s.Clock=n.getClock(),s.prototype.to=function(t,e,i,s,n){return e=null!=e&&e.constructor===String?r[e]:e,0===this._queue.length&&(this._startedAt=this.constructor.Clock.now(),this._pausedAt=null),this._queue.push(t,null!=e?e:r.linear,null!=i?i:100,s,n),this},s.prototype.from=function(t){return this._state=t,this._from=this._sync(null,this._state),this._queue.length=0,this._startedAt=this.constructor.Clock.now(),this._pausedAt=null,this},s.prototype.delay=function(t,e){var i=this._queue.length>0?this._queue[this._queue.length-5]:this._state;return this.to(i,r.flat,t,e)},s.prototype.override=function(t,e,i,s,n){return this._queue.length>0&&(null!=t&&(this._queue[0]=t),null!=e&&(this._queue[1]=e.constructor===String?r[e]:e),null!=i&&(this._queue[2]=i),null!=s&&(this._queue[3]=s),null!=n&&(this._queue[4]=n)),this},s.prototype._interpolate=function(t,e,i,s,r){if(i instanceof Object)if("slerp"===r){var n,o,a,h,u,l,c,p,d,f,m,g,_;if(n=e[0],o=e[1],a=e[2],h=e[3],u=i[0],l=i[1],c=i[2],p=i[3],1===s)return t[0]=u,t[1]=l,t[2]=c,t[3]=p,t;f=h*p+n*u+o*l+a*c,1-f>1e-5?(d=Math.acos(f),m=Math.sin(d),g=Math.sin((1-s)*d)/m,_=Math.sin(s*d)/m):(g=1-s,_=s),t[0]=n*g+u*_,t[1]=o*g+l*_,t[2]=a*g+c*_,t[3]=h*g+p*_}else if(i instanceof Array)for(var v=0,y=i.length;y>v;v++)t[v]=this._interpolate(t[v],e[v],i[v],s,r);else for(var b in i)t[b]=this._interpolate(t[b],e[b],i[b],s,r);else t=e+s*(i-e);return t},s.prototype._sync=function t(e,i){if("number"==typeof i)e=i;else if(i instanceof Array){null==e&&(e=[]);for(var s=0,r=i.length;r>s;s++)e[s]=t(e[s],i[s])}else if(i instanceof Object){null==e&&(e={});for(var n in i)e[n]=t(e[n],i[n])}return e},s.prototype.get=function(t){if(0===this._queue.length)return this._state;t=this._pausedAt?this._pausedAt:t,t=t?t:this.constructor.Clock.now();var e=(t-this._startedAt)/this._queue[2];this._state=this._interpolate(this._state,this._from,this._queue[0],this._queue[1](e>1?1:e),this._queue[4]);var i=this._state;if(e>=1){this._startedAt=this._startedAt+this._queue[2],this._from=this._sync(this._from,this._state),this._queue.shift(),this._queue.shift(),this._queue.shift();var s=this._queue.shift();this._queue.shift(),s&&s()}return e>1?this.get():i},s.prototype.isActive=function(){return this._queue.length>0},s.prototype.halt=function(){return this.from(this.get())},s.prototype.pause=function(){return this._pausedAt=this.constructor.Clock.now(),this},s.prototype.isPaused=function(){return!!this._pausedAt},s.prototype.resume=function(){var t=this._pausedAt-this._startedAt;return this._startedAt=this.constructor.Clock.now()-t,this._pausedAt=null,this},s.prototype.reset=function(t){return this.from(t)},s.prototype.set=function(t,e,i){return null==e?(this.from(t),i&&i()):this.to(t,e.curve,e.duration,i,e.method),this},e.exports=s},{"../core/FamousEngine":9,"./Curves":39}],41:[function(t,e,i){"use strict";function s(){this._events={}}s.prototype.on=function(t,e){this._events[t]||(this._events[t]=[]);var i=this._events[t];return i.push(e),function(){i.splice(i.indexOf(e),1)}},s.prototype.off=function(t,e){var i=this._events[t];return i&&i.splice(i.indexOf(e),1),this},s.prototype.trigger=function(t,e){var i=this._events[t];if(i)for(var s=0,r=i.length;r>s;s++)i[s](e);return this},e.exports=s},{}],42:[function(t,e,i){"use strict";function s(t,e,i){this._r=new r(0),this._g=new r(0),this._b=new r(0),this._opacity=new r(1),t&&this.set(t,e,i)}var r=t("../transitions/Transitionable");s.prototype.toString=function(){return"Color"},s.prototype.set=function(t,e,i){switch(s.determineType(t)){case"hex":return this.setHex(t,e,i);case"colorName":return this.setColor(t,e,i);case"instance":return this.changeTo(t,e,i);case"rgb":return this.setRGB(t[0],t[1],t[2],e,i)}return this},s.prototype.isActive=function(){return this._r.isActive()||this._g.isActive()||this._b.isActive()||this._opacity.isActive()},s.prototype.halt=function(){return this._r.halt(),this._g.halt(),this._b.halt(),this._opacity.halt(),this},s.prototype.changeTo=function(t,e,i){if(s.isColorInstance(t)){var r=t.getRGB();this.setRGB(r[0],r[1],r[2],e,i)}return this},s.prototype.setColor=function(t,e,i){return n[t]&&this.setHex(n[t],e,i),this},s.prototype.getColor=function(t){return s.isString(t)&&(t=t.toLowerCase()),"hex"===t?this.getHex():this.getRGB()},s.prototype.setR=function(t,e,i){return this._r.set(t,e,i),this},s.prototype.setG=function(t,e,i){return this._g.set(t,e,i),this},s.prototype.setB=function(t,e,i){return this._b.set(t,e,i),this},s.prototype.setOpacity=function(t,e,i){return this._opacity.set(t,e,i),this},s.prototype.setRGB=function(t,e,i,s,r){return this.setR(t,s),this.setG(e,s),this.setB(i,s,r),this},s.prototype.getR=function(){return this._r.get()},s.prototype.getG=function(){return this._g.get()},s.prototype.getB=function(){return this._b.get()},s.prototype.getOpacity=function(){return this._opacity.get()},s.prototype.getRGB=function(){return[this.getR(),this.getG(),this.getB()]},s.prototype.getNormalizedRGB=function(){var t=this.getR()/255,e=this.getG()/255,i=this.getB()/255;return[t,e,i]},s.prototype.getNormalizedRGBA=function(){var t=this.getR()/255,e=this.getG()/255,i=this.getB()/255,s=this.getOpacity();return[t,e,i,s]},s.prototype.getHex=function(){var t=s.toHex(this.getR()),e=s.toHex(this.getG()),i=s.toHex(this.getB());return"#"+t+e+i},s.prototype.setHex=function(t,e,i){if(t="#"===t.charAt(0)?t.substring(1,t.length):t,3===t.length){var s=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(s,function(t,e,i,s){return e+e+i+i+s+s})}var r=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16);return this.setRGB(r,n,o,e,i),this},s.toHex=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},s.determineType=function(t){return s.isColorInstance(t)?"instance":n[t]?"colorName":s.isHex(t)?"hex":Array.isArray(t)?"rgb":void 0},s.isString=function(t){return"string"==typeof t},s.isHex=function(t){return s.isString(t)?"#"===t[0]:!1},s.isColorInstance=function(t){return!!t.getColor};var n={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};e.exports=s},{"../transitions/Transitionable":40}],43:[function(t,e,i){"use strict";var s=function t(e){var i;if("object"==typeof e){i=e instanceof Array?[]:{};for(var s in e)if("object"==typeof e[s]&&null!==e[s])if(e[s]instanceof Array){i[s]=new Array(e[s].length);for(var r=0;r<e[s].length;r++)i[s][r]=t(e[s][r])}else i[s]=t(e[s]);else i[s]=e[s]}else i=e;return i};e.exports=s},{}],44:[function(t,e,i){"use strict";e.exports=function(t){var e=[],i=[],s=0;for(var r in t)t.hasOwnProperty(r)&&(e[s]=r,i[s]=t[r],s++);return{keys:e,values:i}}},{}],45:[function(t,e,i){"use strict";var s=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},i.open("GET",t),i.send()};e.exports=s},{}],46:[function(t,e,i){"use strict";function s(t){for(var e=0;e<r.length;e++){var i=r[e]+t;if(""===document.documentElement.style[i])return i}return t}var r=["","-ms-","-webkit-","-moz-","-o-"];e.exports=s},{}],47:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.spec.dynamic=!0}var r=t("./Geometry");s.prototype.getLength=function(){return this.getVertexPositions().length},s.prototype.getVertexBuffer=function(t){if(!t)throw"getVertexBuffer requires a name";var e=this.spec.bufferNames.indexOf(t);if(~e)return this.spec.bufferValues[e];throw"buffer does not exist"},s.prototype.setVertexBuffer=function(t,e,i){var s=this.spec.bufferNames.indexOf(t);return-1===s&&(s=this.spec.bufferNames.push(t)-1),this.spec.bufferValues[s]=e||[],this.spec.bufferSpacings[s]=i||this.DEFAULT_BUFFER_SIZE,-1===this.spec.invalidations.indexOf(s)&&this.spec.invalidations.push(s),this},s.prototype.fromGeometry=function(t){for(var e=t.spec.bufferNames.length,i=0;e>i;i++)this.setVertexBuffer(t.spec.bufferNames[i],t.spec.bufferValues[i],t.spec.bufferSpacings[i]);return this},s.prototype.setVertexPositions=function(t){return this.setVertexBuffer("a_pos",t,3)},s.prototype.setNormals=function(t){return this.setVertexBuffer("a_normals",t,3)},s.prototype.setTextureCoords=function(t){return this.setVertexBuffer("a_texCoord",t,2)},s.prototype.setIndices=function(t){return this.setVertexBuffer("indices",t,1)},s.prototype.setDrawType=function(t){return this.spec.type=t.toUpperCase(),this},s.prototype.getVertexPositions=function(){return this.getVertexBuffer("a_pos")},s.prototype.getNormals=function(){return this.getVertexBuffer("a_normals")},s.prototype.getTextureCoords=function(){return this.getVertexBuffer("a_texCoord")},e.exports=s},{"./Geometry":48}],48:[function(t,e,i){"use strict";function s(t){if(this.options=t||{},this.DEFAULT_BUFFER_SIZE=3,this.spec={id:r++,dynamic:!1,type:this.options.type||"TRIANGLES",bufferNames:[],bufferValues:[],bufferSpacings:[],invalidations:[]},this.options.buffers)for(var e=this.options.buffers.length,i=0;e>i;)this.spec.bufferNames.push(this.options.buffers[i].name),this.spec.bufferValues.push(this.options.buffers[i].data),this.spec.bufferSpacings.push(this.options.buffers[i].size||this.DEFAULT_BUFFER_SIZE),this.spec.invalidations.push(i++)}var r=0;e.exports=s},{}],49:[function(t,e,i){"use strict";function s(t,e){return-(e+(t-e)/2)}function r(t,e){return 1/((t-e)/2)}var n=t("../math/Vec3"),o=t("../math/Vec2"),a=[new n,new n,new n,new o,new o],h={};h.generateParametric=function(t,e,i,s){var r,n,o,a,h=[],u=s?Math.PI+Math.PI/(t-1):Math.PI,l=[];for(r=0;t+1>r;r++)for(n=r*u/t,a=0;e>a;a++)o=2*a*u/e,i(n,o,l),h.push(l[0],l[1],l[2]);var c,p=[],d=0;for(r=0;t>r;r++){for(a=0;e>a;a++)c=(a+1)%e,p.push(d+a,d+a+e,d+c),p.push(d+c,d+a+e,d+c+e);d+=e}return{vertices:h,indices:p}},h.computeNormals=function(t,e,i){var s,r,n,o,h,u,l,c,p,d,f=i||[],m=e.length/3;for(u=0;m>u;u++)r=3*e[3*u+0],s=3*e[3*u+1],n=3*e[3*u+2],a[0].set(t[s],t[s+1],t[s+2]),a[1].set(t[r],t[r+1],t[r+2]),a[2].set(t[n],t[n+1],t[n+2]),o=a[2].subtract(a[0]).cross(a[1].subtract(a[0])).normalize(),f[s+0]=(f[s+0]||0)+o.x,f[s+1]=(f[s+1]||0)+o.y,f[s+2]=(f[s+2]||0)+o.z,f[r+0]=(f[r+0]||0)+o.x,f[r+1]=(f[r+1]||0)+o.y,f[r+2]=(f[r+2]||0)+o.z,f[n+0]=(f[n+0]||0)+o.x,f[n+1]=(f[n+1]||0)+o.y,f[n+2]=(f[n+2]||0)+o.z;for(u=0;u<f.length;u+=3)for(l=f[u],c=f[u+1],p=f[u+2],d=Math.sqrt(l*l+c*c+p*p),h=0;3>h;h++)f[u+h]/=d;return f},h.subdivide=function(t,e,i){for(var s,r,h,u,l,c,p=t.length/3;p--;)s=t.slice(3*p,3*p+3),l=s.map(function(t){return new n(e[3*t],e[3*t+1],e[3*t+2])}),e.push.apply(e,n.scale(n.add(l[0],l[1],a[0]),.5,a[1]).toArray()),e.push.apply(e,n.scale(n.add(l[1],l[2],a[0]),.5,a[1]).toArray()),e.push.apply(e,n.scale(n.add(l[0],l[2],a[0]),.5,a[1]).toArray()),i&&(c=s.map(function(t){return new o(i[2*t],i[2*t+1])}),i.push.apply(i,o.scale(o.add(c[0],c[1],a[3]),.5,a[4]).toArray()),i.push.apply(i,o.scale(o.add(c[1],c[2],a[3]),.5,a[4]).toArray()),i.push.apply(i,o.scale(o.add(c[0],c[2],a[3]),.5,a[4]).toArray())),r=e.length-3,h=r+1,u=r+2,t.push(r,h,u),t.push(s[0],r,u),t.push(r,s[1],h),t[p]=u,t[p+1]=h,t[p+2]=s[2]},h.getUniqueFaces=function(t,e){for(var i,s=e.length/3,r=[];s--;)for(var n=0;3>n;n++)i=e[3*s+n],r[i]?(t.push(t[3*i],t[3*i+1],t[3*i+2]),e[3*s+n]=t.length/3-1):r[i]=!0},h.subdivideSpheroid=function(t,e){for(var i,s,r,o,h,u=e.length/3;u--;)s=e.slice(3*u,3*u+3),i=s.map(function(e){return new n(t[3*e],t[3*e+1],t[3*e+2])}),t.push.apply(t,n.normalize(n.add(i[0],i[1],a[0]),a[1]).toArray()),t.push.apply(t,n.normalize(n.add(i[1],i[2],a[0]),a[1]).toArray()),t.push.apply(t,n.normalize(n.add(i[0],i[2],a[0]),a[1]).toArray()),r=t.length/3-3,o=r+1,h=r+2,e.push(r,o,h),e.push(s[0],r,h),e.push(r,s[1],o),e[3*u]=h,e[3*u+1]=o,e[3*u+2]=s[2]},h.getSpheroidNormals=function(t,e){e=e||[];for(var i,s=t.length/3,r=0;s>r;r++)i=new n(t[3*r+0],t[3*r+1],t[3*r+2]).normalize().toArray(),e[3*r+0]=i[0],e[3*r+1]=i[1],e[3*r+2]=i[2];return e},h.getSpheroidUV=function(t,e){e=e||[];for(var i,s=t.length/3,r=[],n=0;s>n;n++)i=a[0].set(t[3*n],t[3*n+1],t[3*n+2]).normalize().toArray(),r[0]=.5*this.getAzimuth(i)/Math.PI+.5,r[1]=this.getAltitude(i)/Math.PI+.5,e.push.apply(e,r);return e},h.normalizeAll=function(t,e){e=e||[];for(var i=t.length/3,s=0;i>s;s++)Array.prototype.push.apply(e,new n(t[3*s],t[3*s+1],t[3*s+2]).normalize().toArray());return e},h.normalizeVertices=function(t,e){e=e||[];var i,o,a,h,u,l,c,p,d=t.length/3,f=[];for(p=0;d>p;p++)c=f[p]=new n(t[3*p],t[3*p+1],t[3*p+2]),(null==i||c.x<i)&&(i=c.x),(null==o||c.x>o)&&(o=c.x),(null==a||c.y<a)&&(a=c.y),(null==h||c.y>h)&&(h=c.y),(null==u||c.z<u)&&(u=c.z),(null==l||c.z>l)&&(l=c.z);var m=new n(s(o,i),s(h,a),s(l,u)),g=Math.min(r(o+m.x,i+m.x),r(h+m.y,a+m.y),r(l+m.z,u+m.z));for(p=0;p<f.length;p++)e.push.apply(e,f[p].add(m).scale(g).toArray());return e},h.getAzimuth=function(t){return Math.atan2(t[2],-t[0])},h.getAltitude=function(t){return Math.atan2(-t[1],Math.sqrt(t[0]*t[0]+t[2]*t[2]))},h.trianglesToLines=function(t,e){var i=t.length/3;e=e||[];var s;for(s=0;i>s;s++)e.push(t[3*s+0],t[3*s+1]),e.push(t[3*s+1],t[3*s+2]),e.push(t[3*s+2],t[3*s+0]);return e},h.addBackfaceTriangles=function(t,e){for(var i=e.length/3,s=0,r=e.length;r--;)e[r]>s&&(s=e[r]);for(s++,r=0;i>r;r++){var n=e[3*r],o=e[3*r+1],a=e[3*r+2];e.push(n+s,a+s,o+s)}var h=t.length;for(r=0;h>r;r++)t.push(t[r])},e.exports=h},{"../math/Vec2":28,"../math/Vec3":29}],50:[function(t,e,i){"use strict";function s(t,e){t=n(t);var i=t.split("\n"),s=[];e=e||{};for(var o,a,h,u,l,c,p=[],d=[],f=[],m=[],g=[],_=[],v=i.length,y=0;v>y;y++)c=i[y],l=i[y].trim().split(" "),-1!==c.indexOf("v ")?_.push([parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3])]):-1!==c.indexOf("vt ")?g.push([parseFloat(l[1]),parseFloat(l[2])]):-1!==c.indexOf("vn ")?m.push([parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3])]):-1!==c.indexOf("f ")?-1!==l[1].indexOf("//")?(o=l[1].split("//"),a=l[2].split("//"),h=l[3].split("//"),d.push([parseFloat(o[0])-1,parseFloat(a[0])-1,parseFloat(h[0])-1]),f.push([parseFloat(o[1])-1,parseFloat(a[1])-1,parseFloat(h[1])-1]),l[4]&&(u=l[4].split("//"),d.push([parseFloat(o[0])-1,parseFloat(h[0])-1,parseFloat(u[0])-1]),f.push([parseFloat(o[2])-1,parseFloat(h[2])-1,parseFloat(u[2])-1]))):-1!==l[1].indexOf("/")?(o=l[1].split("/"),a=l[2].split("/"),h=l[3].split("/"),d.push([parseFloat(o[0])-1,parseFloat(a[0])-1,parseFloat(h[0])-1]),p.push([parseFloat(o[1])-1,parseFloat(a[1])-1,parseFloat(h[1])-1]),f.push([parseFloat(o[2])-1,parseFloat(a[2])-1,parseFloat(h[2])-1]),l[4]&&(u=l[4].split("/"),d.push([parseFloat(o[0])-1,parseFloat(h[0])-1,parseFloat(u[0])-1]),p.push([parseFloat(o[1])-1,parseFloat(h[1])-1,parseFloat(u[1])-1]),f.push([parseFloat(o[2])-1,parseFloat(h[2])-1,parseFloat(u[2])-1]))):(d.push([parseFloat(l[1])-1,parseFloat(l[2])-1,parseFloat(l[3])-1]),p.push([parseFloat(l[1])-1,parseFloat(l[2])-1,parseFloat(l[3])-1]),f.push([parseFloat(l[1])-1,parseFloat(l[2])-1,parseFloat(l[3])-1]),l[4]&&(d.push([parseFloat(l[1])-1,parseFloat(l[3])-1,parseFloat(l[4])-1]),p.push([parseFloat(l[1])-1,parseFloat(l[3])-1,parseFloat(l[4])-1]),f.push([parseFloat(l[1])-1,parseFloat(l[3])-1,parseFloat(l[4])-1]))):-1!==c.indexOf("g ")&&(d.length&&s.push(r(_,m,g,d,f,p,e)),d.length=0,p.length=0,f.length=0);return s.push(r(_,m,g,d,f,p,e)),s}function r(t,e,i,s,r,n,h){var l=o(t,e,i,s,r,n);return l.vertices=a(l.vertices),l.normals=a(l.normals),l.texCoords=a(l.texCoords),l.indices=a(l.indices),h.normalize&&(l.vertices=u.normalizeVertices(l.vertices)),h.computeNormals&&(l.normals=u.computeNormals(l.vertices,l.indices)),{vertices:l.vertices,normals:l.normals,textureCoords:l.texCoords,indices:l.indices}}function n(t){return t.replace(/ +(?= )/g,"").replace(/\s+$/g,"")}function o(t,e,i,s,r,n){for(var o,a,h,u,l,c=[],p=[],d=[],f=[],m={},g=0,_=s.length,v=r.length,y=n.length,b=0;_>b;b++){f[b]=[],u=s[b].length;for(var w=0;u>w;w++)y&&(h=n[b][w]),v&&(a=r[b][w]),o=s[b][w],l=m[o+","+a+","+h],void 0===l&&(l=g++,p.push(t[o]),v&&c.push(e[a]),y&&d.push(i[h]),m[o+","+a+","+h]=l),f[b].push(l)}return{vertices:p,normals:c,texCoords:d,indices:f}}function a(t){for(var e=t.length,i=[],s=0;e>s;s++)i.push.apply(i,t[s]);return i}var h=t("../utilities/loadURL"),u=t("./GeometryHelper"),l={cached:{},requests:{},formatText:s};l.load=function(t,e,i){this.cached[t]?e(this.cached[t]):this.requests[t]?this.requests[t].push(e):(this.requests[t]=[e],h(t,this._onsuccess.bind(this,t,i)))},l._onsuccess=function(t,e,i){var r=s.call(this,i,e||{});this.cached[t]=r;for(var n=0;n<this.requests[t].length;n++)this.requests[t][n](r);this.requests[t]=null},e.exports=l},{"../utilities/loadURL":45,"./GeometryHelper":49}],51:[function(t,e,i){"use strict";e.exports={Box:t("./primitives/Box"),Circle:t("./primitives/Circle"),Cylinder:t("./primitives/Cylinder"),GeodesicSphere:t("./primitives/GeodesicSphere"),Icosahedron:t("./primitives/Icosahedron"),ParametricCone:t("./primitives/ParametricCone"),Plane:t("./primitives/Plane"),Sphere:t("./primitives/Sphere"),Tetrahedron:t("./primitives/Tetrahedron"),Torus:t("./primitives/Torus"),Triangle:t("./primitives/Triangle"),GeometryHelper:t("./GeometryHelper"),DynamicGeometry:t("./DynamicGeometry"),Geometry:t("./Geometry"),OBJLoader:t("./OBJLoader")}},{"./DynamicGeometry":47,"./Geometry":48,"./GeometryHelper":49,"./OBJLoader":50,"./primitives/Box":52,"./primitives/Circle":53,"./primitives/Cylinder":54,"./primitives/GeodesicSphere":55,
"./primitives/Icosahedron":56,"./primitives/ParametricCone":57,"./primitives/Plane":58,"./primitives/Sphere":59,"./primitives/Tetrahedron":60,"./primitives/Torus":61,"./primitives/Triangle":62}],52:[function(t,e,i){"use strict";function s(t){return[2*(1&t)-1,(2&t)-1,(4&t)/2-1]}function r(t){t=t||{};var e,i,r,a,h,u=[],l=[],c=[],p=[];for(a=0;a<o.length;a++){for(e=o[a],r=4*a,h=0;4>h;h++){i=e[h];var d=s(i);u.push(d[0],d[1],d[2]),l.push(1&h,(2&h)/2),c.push(e[4],e[5],e[6])}p.push(r,r+1,r+2),p.push(r+2,r+1,r+3)}return new n({buffers:[{name:"a_pos",data:u},{name:"a_texCoord",data:l,size:2},{name:"a_normals",data:c},{name:"indices",data:p,size:1}]})}var n=t("../Geometry"),o=[[0,4,2,6,-1,0,0],[1,3,5,7,1,0,0],[0,1,4,5,0,-1,0],[2,6,3,7,0,1,0],[0,2,1,3,0,0,-1],[4,5,6,7,0,0,1]];e.exports=r},{"../Geometry":48}],53:[function(t,e,i){"use strict";function s(t){t=t||{};var e=t.detail||30,i=n(e,!0);t.backface!==!1&&a.addBackfaceTriangles(i.vertices,i.indices);var s=r(i.vertices),h=a.computeNormals(i.vertices,i.indices);return new o({buffers:[{name:"a_pos",data:i.vertices},{name:"a_texCoord",data:s,size:2},{name:"a_normals",data:h},{name:"indices",data:i.indices,size:1}]})}function r(t){for(var e=[],i=t.length/3,s=0;i>s;s++){var r=t[3*s],n=t[3*s+1];e.push(.5+.5*r,.5+.5*-n)}return e}function n(t){for(var e,i,s,r=[0,0,0],n=[],o=1,a=0;t+1>a;a++)e=a/t*Math.PI*2,i=Math.cos(e),s=Math.sin(e),r.push(i,s,0),a>0&&n.push(0,o,++o);return{vertices:r,indices:n}}var o=t("../Geometry"),a=t("../GeometryHelper");e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],54:[function(t,e,i){"use strict";function s(t){t=t||{};var e,i=t.radius||1,o=t.detail||15;return e=n.generateParametric(o,o,s.generator.bind(null,i)),t.backface!==!1&&n.addBackfaceTriangles(e.vertices,e.indices),new r({buffers:[{name:"a_pos",data:e.vertices},{name:"a_texCoord",data:n.getSpheroidUV(e.vertices),size:2},{name:"a_normals",data:n.computeNormals(e.vertices,e.indices)},{name:"indices",data:e.indices,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");s.generator=function(t,e,i,s){s[1]=t*Math.sin(i),s[0]=t*Math.cos(i),s[2]=t*(-1+e/Math.PI*2)},e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],55:[function(t,e,i){"use strict";function s(t){var e=.5*(1+Math.sqrt(5)),i=[-1,e,0,1,e,0,-1,-e,0,1,-e,0,0,-1,-e,0,1,-e,0,-1,e,0,1,e,e,0,1,e,0,-1,-e,0,1,-e,0,-1],s=[0,5,11,0,1,5,0,7,1,0,10,7,0,11,10,1,9,5,5,4,11,11,2,10,10,6,7,7,8,1,3,4,9,3,2,4,3,6,2,3,8,6,3,9,8,4,5,9,2,11,4,6,10,2,8,7,6,9,1,8];i=n.normalizeAll(i),t=t||{};for(var o=t.detail||3;--o;)n.subdivideSpheroid(i,s);n.getUniqueFaces(i,s);var a=n.computeNormals(i,s),h=n.getSpheroidUV(i);return new r({buffers:[{name:"a_pos",data:i},{name:"a_texCoord",data:h,size:2},{name:"a_normals",data:a},{name:"indices",data:s,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],56:[function(t,e,i){"use strict";function s(){var t=(1+Math.sqrt(5))/2,e=[-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,-t,0,1,-t,0,-1,t,0,1,t,t,0,1,t,0,-1,-t,0,1,-t,0,-1],i=[0,5,11,0,1,5,0,7,1,0,10,7,0,11,10,1,9,5,5,4,11,11,2,10,10,6,7,7,8,1,3,4,9,3,2,4,3,6,2,3,8,6,3,9,8,4,5,9,2,11,4,6,10,2,8,7,6,9,1,8];n.getUniqueFaces(e,i);var s=n.computeNormals(e,i),o=n.getSpheroidUV(e);return e=n.normalizeAll(e),new r({buffers:[{name:"a_pos",data:e},{name:"a_texCoord",data:o,size:2},{name:"a_normals",data:s},{name:"indices",data:i,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],57:[function(t,e,i){"use strict";function s(t){t=t||{};var e=t.detail||15,i=t.radius||1/Math.PI,o=n.generateParametric(e,e,s.generator.bind(null,i));return t.backface!==!1&&n.addBackfaceTriangles(o.vertices,o.indices),new r({buffers:[{name:"a_pos",data:o.vertices},{name:"a_texCoord",data:n.getSpheroidUV(o.vertices),size:2},{name:"a_normals",data:n.computeNormals(o.vertices,o.indices)},{name:"indices",data:o.indices,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");s.generator=function(t,e,i,s){s[0]=-t*e*Math.cos(i),s[1]=t*e*Math.sin(i),s[2]=-e/(Math.PI/2)+1},e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],58:[function(t,e,i){"use strict";function s(t){t=t||{};for(var e,i=t.detailX||t.detail||1,s=t.detailY||t.detail||1,o=[],a=[],h=[],u=[],l=0;s>=l;l++)for(var c=l/s,p=0;i>=p;p++){var d=p/i;o.push(2*(d-.5),2*(c-.5),0),a.push(d,1-c),i>p&&s>l&&(e=p+l*(i+1),u.push(e,e+1,e+i+1),u.push(e+i+1,e+1,e+i+2))}if(t.backface!==!1){n.addBackfaceTriangles(o,u);var f=a.length;for(e=0;f>e;e++)a.push(a[e])}return h=n.computeNormals(o,u),new r({buffers:[{name:"a_pos",data:o},{name:"a_texCoord",data:a,size:2},{name:"a_normals",data:h},{name:"indices",data:u,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],59:[function(t,e,i){"use strict";function s(t){t=t||{};var e=t.detail||10,i=t.detailX||e,o=t.detailY||e,a=n.generateParametric(i,o,s.generator,!0);return n.getUniqueFaces(a.vertices,a.indices),new r({buffers:[{name:"a_pos",data:a.vertices},{name:"a_texCoord",data:n.getSpheroidUV(a.vertices),size:2},{name:"a_normals",data:n.getSpheroidNormals(a.vertices)},{name:"indices",data:a.indices,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");s.generator=function(t,e,i){var s=Math.sin(t)*Math.cos(e),r=Math.cos(t),n=-Math.sin(t)*Math.sin(e);i[0]=s,i[1]=r,i[2]=n},e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],60:[function(t,e,i){"use strict";function s(t){var e,i,s=[],o=[],a=Math.sqrt(3),h=[1,-1,-1/a,-1,-1,-1/a,0,1,0,0,1,0,0,-1,a-1/a,1,-1,-1/a,0,1,0,-1,-1,-1/a,0,-1,a-1/a,0,-1,a-1/a,-1,-1,-1/a,1,-1,-1/a],u=[0,1,2,3,4,5,6,7,8,9,10,11];for(i=0;4>i;i++)s.push(0,0,.5,1,1,0);for(t=t||{};--e;)n.subdivide(u,h,s);return o=n.computeNormals(h,u),new r({buffers:[{name:"a_pos",data:h},{name:"a_texCoord",data:s,size:2},{name:"a_normals",data:o},{name:"indices",data:u,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],61:[function(t,e,i){"use strict";function s(t){t=t||{};var e=t.detail||30,i=t.holeRadius||.8,o=t.tubeRadius||.2,a=n.generateParametric(e,e,s.generator.bind(null,i,o));return new r({buffers:[{name:"a_pos",data:a.vertices},{name:"a_texCoord",data:n.getSpheroidUV(a.vertices),size:2},{name:"a_normals",data:n.computeNormals(a.vertices,a.indices)},{name:"indices",data:a.indices,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");s.generator=function(t,e,i,s,r){r[0]=(t+e*Math.cos(2*s))*Math.sin(2*i),r[1]=-(t+e*Math.cos(2*s))*Math.cos(2*i),r[2]=e*Math.sin(2*s)},e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],62:[function(t,e,i){"use strict";function s(t){t=t||{};for(var e=t.detail||1,i=[],s=[0,0,.5,1,1,0],o=[0,1,2],a=[-1,-1,0,0,1,0,1,-1,0];--e;)n.subdivide(o,a,s);return t.backface!==!1&&n.addBackfaceTriangles(a,o),i=n.computeNormals(a,o),new r({buffers:[{name:"a_pos",data:a},{name:"a_texCoord",data:s,size:2},{name:"a_normals",data:i},{name:"indices",data:o,size:1}]})}var r=t("../Geometry"),n=t("../GeometryHelper");e.exports=s},{"../Geometry":48,"../GeometryHelper":49}],63:[function(t,e,i){"use strict";function s(t,e,i,n){n=n||{},this.name=t,this.chunk=e,this.inputs=i?Array.isArray(i)?i:[i]:[],this.uniforms=n.uniforms||{},this.varyings=n.varyings,this.attributes=n.attributes,n.texture&&(this.texture=n.texture.__isATexture__?n.texture:r.register(null,n.texture)),this._id=s.id++,this.invalidations=[],this.__isAMaterial__=!0}var r=t("./TextureRegistry"),n={},o={abs:{glsl:"abs(%1);",output:{4:4,3:3,2:2,1:1}},sign:{glsl:"sign(%1);",output:{4:4,3:3,2:2,1:1}},floor:{glsl:"floor(%1);",output:{4:4,3:3,2:2,1:1}},ceiling:{glsl:"ceil(%1);",output:{4:4,3:3,2:2,1:1}},mod:{glsl:"mod(%1, %2);"},min:{glsl:"min(%1, %2);",output:{4:4,3:3,2:2,1:1}},max:{glsl:"max(%1, %2);",output:{4:4,3:3,2:2,1:1}},clamp:{glsl:"clamp(%1, %2, %3);",output:{"4,1,1":4,"3,1,1":3,"2,1,1":2,"1,1,1":1}},mix:{glsl:"mix(%1, %2, %3);",output:{"4,4,1":4,"3,3,1":3,"2,2,1":2,"1,1,1":1}},step:{glsl:"step(%1, %2, %3);",output:{"1,1":1,"1,2":2,"1,3":3,"1,4":4}},smoothstep:{glsl:"smoothstep(%1);",output:{"1,1,1":1,"2,2,2":2,"3,3,3":3,"4,4,4":4}},fragCoord:{glsl:"gl_FragColor;",output:4},sin:{glsl:"sin(%1);",output:{1:1,2:2,3:3,4:4}},cos:{glsl:"cos(%1);",output:{1:1,2:2,3:3,4:4}},pow:{glsl:"pow(%1, %2);",output:{"1,1":1,"2,2":2,"3,3":3,"1,4":4}},sqrt:{glsl:"sqrt(%1);",output:{"1,1":1,"2,2":2,"3,3":3,"1,4":4}},time:{glsl:"time;",output:1},add:{glsl:"%1 + %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},subtract:{glsl:"%1 - %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},multiply:{glsl:"%1 * %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},normal:{glsl:"vec4((v_normal + 1.0) * 0.5, 1.0);",output:4},uv:{glsl:"v_textureCoordinate;",output:2},meshPosition:{glsl:"(v_position + 1.0) * 0.5;",output:3},normalize:{glsl:"normalize(%1)",output:{1:1,2:2,3:3,4:4}},dot:{glsl:"dot(%1, %2);",output:{"1,1":1,"2,2":1,"3,3":1,"4,4":1}},image:{glsl:"texture2D($TEXTURE, v_textureCoordinate);",output:4},constant:{glsl:"%1;"},parameter:{uniforms:{parameter:1},glsl:"parameter;"},vec3:{glsl:"vec3(%1);",output:3},vec2:{glsl:"vec2(%1);",output:2}};n.registerExpression=function(t,e){this[t]=function(i,r){return new s(t,e,i,r)}};for(var a in o)n.registerExpression(a,o[a]);s.id=2,s.prototype.setUniform=function(t,e){this.uniforms[t]=e,this.invalidations.push(t)},e.exports=n,n.Material=s,n.Texture=function(t){return"undefined"==typeof window?console.error("Texture constructor cannot be run inside of a worker"):n.image([],{texture:t})},n.Custom=function(t,e,i){return new s("custom",{glsl:t,output:1,uniforms:i||{}},e)}},{"./TextureRegistry":64}],64:[function(t,e,i){"use strict";var s={registry:{},textureIds:1};s.register=function(t,e,i){return t?(this.registry[t]={id:this.textureIds++,__isATexture__:!0,data:e,options:i},this.registry[t]):{id:this.textureIds++,data:e,__isATexture__:!0,options:i}},s.get=function(t){if(this.registry[t])return this.registry[t];throw'Texture "'+t+'" not found!'},e.exports=s},{}],65:[function(t,e,i){"use strict";function s(t,e){this._node=t,this._changeQueue=[],this._initialized=!1,this._requestingUpdate=!1,this._inDraw=!1,this.value={drawOptions:{},color:null,expressions:{},geometry:null,flatShading:null,glossiness:null,positionOffset:null,normals:null},e&&this.setDrawOptions(e),this._id=t.addComponent(this)}var r=t("../webgl-geometries");s.prototype.setDrawOptions=function(t){return this._changeQueue.push("GL_SET_DRAW_OPTIONS"),this._changeQueue.push(t),this},s.prototype.getDrawOptions=function(){return this.value.drawOptions},s.prototype.setGeometry=function(t,e){if("string"==typeof t){if(!r[t])throw'Invalid geometry: "'+t+'".';t=new r[t](e)}if((this.value.geometry!==t||this._inDraw)&&(this._initialized&&(this._changeQueue.push("GL_SET_GEOMETRY"),this._changeQueue.push(t.spec.id),this._changeQueue.push(t.spec.type),this._changeQueue.push(t.spec.dynamic)),this._requestUpdate(),this.value.geometry=t),this._initialized&&this._node){for(var i=this.value.geometry.spec.invalidations.length;i--;)this.value.geometry.spec.invalidations.pop(),this._changeQueue.push("GL_BUFFER_DATA"),this._changeQueue.push(this.value.geometry.spec.id),this._changeQueue.push(this.value.geometry.spec.bufferNames[i]),this._changeQueue.push(this.value.geometry.spec.bufferValues[i]),this._changeQueue.push(this.value.geometry.spec.bufferSpacings[i]),this._changeQueue.push(this.value.geometry.spec.dynamic);i&&this._requestUpdate()}return this},s.prototype.getGeometry=function(){return this.value.geometry},s.prototype.setBaseColor=function(t){var e,i=t.__isAMaterial__,s=!!t.getNormalizedRGBA;return i?(this.value.color=null,this.value.expressions.baseColor=t,e=t):s&&(this.value.expressions.baseColor=null,this.value.color=t,e=t.getNormalizedRGBA()),this._initialized&&(i?this._changeQueue.push("MATERIAL_INPUT"):s&&this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_baseColor"),this._changeQueue.push(e)),this._requestUpdate(),this},s.prototype.getBaseColor=function(){return this.value.expressions.baseColor||this.value.color},s.prototype.setFlatShading=function(t){return(this._inDraw||this.value.flatShading!==t)&&(this.value.flatShading=t,this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_flatShading"),this._changeQueue.push(t?1:0)),this._requestUpdate()),this},s.prototype.getFlatShading=function(){return this.value.flatShading},s.prototype.setNormals=function(t){var e=t.__isAMaterial__;return e&&(this.value.expressions.normals=t),this._initialized&&(this._changeQueue.push(e?"MATERIAL_INPUT":"UNIFORM_INPUT"),this._changeQueue.push("u_normals"),this._changeQueue.push(t)),this._requestUpdate(),this},s.prototype.getNormals=function(t){return this.value.expressions.normals},s.prototype.setGlossiness=function(t,e){var i=t.__isAMaterial__,s=!!t.getNormalizedRGB;return i?(this.value.glossiness=[null,null],this.value.expressions.glossiness=t):s&&(this.value.expressions.glossiness=null,this.value.glossiness=[t,e||20],t=t?t.getNormalizedRGB():[0,0,0],t.push(e||20)),this._initialized&&(this._changeQueue.push(i?"MATERIAL_INPUT":"GL_UNIFORMS"),this._changeQueue.push("u_glossiness"),this._changeQueue.push(t)),this._requestUpdate(),this},s.prototype.getGlossiness=function(){return this.value.expressions.glossiness||this.value.glossiness},s.prototype.setPositionOffset=function(t){var e,i=t.__isAMaterial__;return i?(this.value.expressions.positionOffset=t,e=t):(this.value.expressions.positionOffset=null,this.value.positionOffset=t,e=this.value.positionOffset),this._initialized&&(this._changeQueue.push(i?"MATERIAL_INPUT":"GL_UNIFORMS"),this._changeQueue.push("u_positionOffset"),this._changeQueue.push(e)),this._requestUpdate(),this},s.prototype.getPositionOffset=function(){return this.value.expressions.positionOffset||this.value.positionOffset},s.prototype.getMaterialExpressions=function(){return this.value.expressions},s.prototype.getValue=function(){return this.value},s.prototype._pushInvalidations=function(t){var e,i=this.value.expressions[t];if(i)for(var s=i.invalidations.length;s--;)e=i.invalidations.pop(),this._node.sendDrawCommand("GL_UNIFORMS"),this._node.sendDrawCommand(e),this._node.sendDrawCommand(i.uniforms[e]);return this},s.prototype.onUpdate=function(){var t=this._node,e=this._changeQueue;if(t){if(t.sendDrawCommand("WITH"),t.sendDrawCommand(t.getLocation()),this.value.color&&this.value.color.isActive()&&(this._node.sendDrawCommand("GL_UNIFORMS"),this._node.sendDrawCommand("u_baseColor"),this._node.sendDrawCommand(this.value.color.getNormalizedRGBA()),this._node.requestUpdateOnNextTick(this._id)),this.value.glossiness&&this.value.glossiness[0]&&this.value.glossiness[0].isActive()){this._node.sendDrawCommand("GL_UNIFORMS"),this._node.sendDrawCommand("u_glossiness");var i=this.value.glossiness[0].getNormalizedRGB();i.push(this.value.glossiness[1]),this._node.sendDrawCommand(i),this._node.requestUpdateOnNextTick(this._id)}else this._requestingUpdate=!1;this._pushInvalidations("baseColor"),this._pushInvalidations("positionOffset");for(var s=0;s<e.length;s++)t.sendDrawCommand(e[s]);e.length=0}},s.prototype.onMount=function(t,e){this._node=t,this._id=e,this.draw()},s.prototype.onDismount=function(){this._initialized=!1,this._changeQueue.push("GL_REMOVE_MESH"),this._requestUpdate()},s.prototype.onShow=function(){this._changeQueue.push("GL_MESH_VISIBILITY",!0),this._requestUpdate()},s.prototype.onHide=function(){this._changeQueue.push("GL_MESH_VISIBILITY",!1),this._requestUpdate()},s.prototype.onTransformChange=function(t){this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_transform"),this._changeQueue.push(t)),this._requestUpdate()},s.prototype.onSizeChange=function(t){this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_size"),this._changeQueue.push(t)),this._requestUpdate()},s.prototype.onOpacityChange=function(t){this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_opacity"),this._changeQueue.push(t)),this._requestUpdate()},s.prototype.onAddUIEvent=function(t){},s.prototype._requestUpdate=function(){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0)},s.prototype.init=function(){this._initialized=!0,this.onTransformChange(this._node.getTransform()),this.onSizeChange(this._node.getSize()),this.onOpacityChange(this._node.getOpacity()),this._requestUpdate()},s.prototype.draw=function(){this._inDraw=!0,this.init();var t=this.getValue();null!=t.geometry&&this.setGeometry(t.geometry),null!=t.color&&this.setBaseColor(t.color),null!=t.glossiness&&this.setGlossiness.apply(this,t.glossiness),null!=t.drawOptions&&this.setDrawOptions(t.drawOptions),null!=t.flatShading&&this.setFlatShading(t.flatShading),null!=t.expressions.normals&&this.setNormals(t.expressions.normals),null!=t.expressions.baseColor&&this.setBaseColor(t.expressions.baseColor),null!=t.expressions.glossiness&&this.setGlossiness(t.expressions.glossiness),null!=t.expressions.positionOffset&&this.setPositionOffset(t.expressions.positionOffset),this._inDraw=!1},e.exports=s},{"../webgl-geometries":51}],66:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.commands.color="GL_AMBIENT_LIGHT"}var r=t("./Light");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,e.exports=s},{"./Light":67}],67:[function(t,e,i){"use strict";function s(t){this._node=t,this._id=t.addComponent(this),this._requestingUpdate=!1,this.queue=[],this._color=null,this.commands={color:"GL_LIGHT_COLOR"}}s.prototype.setColor=function(t){if(!t.getNormalizedRGB)return!1;this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._color=t,this.queue.push(this.commands.color);var e=this._color.getNormalizedRGB();return this.queue.push(e[0]),this.queue.push(e[1]),this.queue.push(e[2]),this},s.prototype.getColor=function(){return this._color},s.prototype.onUpdate=function(){var t=this._node.getLocation();this._node.sendDrawCommand("WITH").sendDrawCommand(t);for(var e=this.queue.length;e--;)this._node.sendDrawCommand(this.queue.shift());if(this._color&&this._color.isActive()){this._node.sendDrawCommand(this.commands.color);var i=this._color.getNormalizedRGB();this._node.sendDrawCommand(i[0]),this._node.sendDrawCommand(i[1]),this._node.sendDrawCommand(i[2]),this._node.requestUpdateOnNextTick(this._id)}else this._requestingUpdate=!1},e.exports=s},{}],68:[function(t,e,i){"use strict";function s(t){r.call(this,t),this.commands.position="GL_LIGHT_POSITION",this.onTransformChange(t.getTransform())}var r=t("./Light");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.onTransformChange=function(t){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this.queue.push(this.commands.position),this.queue.push(t[12]),this.queue.push(t[13]),this.queue.push(t[14])},e.exports=s},{"./Light":67}],69:[function(t,e,i){"use strict";function s(t,e,i){this.buffer=null,this.target=t,this.type=e,this.data=[],this.gl=i}s.prototype.subData=function(){for(var t=this.gl,e=[],i=0,s=1e4;i<this.data.length;i+=s)e=Array.prototype.concat.apply(e,this.data.slice(i,i+s));this.buffer=this.buffer||t.createBuffer(),t.bindBuffer(this.target,this.buffer),t.bufferData(this.target,new this.type(e),t.STATIC_DRAW)},e.exports=s},{}],70:[function(t,e,i){"use strict";function s(t){this.gl=t,this.registry={},this._dynamicBuffers=[],this._staticBuffers=[],this._arrayBufferMax=3e4,this._elementBufferMax=3e4}var r="indices",n=t("./Buffer");s.prototype.allocate=function(t,e,i,s,o){var a,h,u,l,c=this.registry[t]||(this.registry[t]={keys:[],values:[],spacing:[],offset:[],length:[]}),p=c.keys.indexOf(e),d=e===r,f=!1,m=0;if(-1===p){if(p=c.keys.length,h=d?i.length:Math.floor(i.length/s),o)u=new n(d?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,d?Uint16Array:Float32Array,this.gl),this._dynamicBuffers.push({buffer:u,offset:i.length,isIndex:d});else{for(l=0;l<this._staticBuffers.length;l++)if(d===this._staticBuffers[l].isIndex&&(a=this._staticBuffers[l].offset+i.length,!d&&a<this._arrayBufferMax||d&&a<this._elementBufferMax)){u=this._staticBuffers[l].buffer,m=this._staticBuffers[l].offset,this._staticBuffers[l].offset+=i.length,f=!0;break}f||(u=new n(d?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,d?Uint16Array:Float32Array,this.gl),this._staticBuffers.push({buffer:u,offset:i.length,isIndex:d}))}c.keys.push(e),c.values.push(u),c.spacing.push(s),c.offset.push(m),c.length.push(h)}var g=i.length;for(l=0;g>l;l++)c.values[p].data[m+l]=i[l];c.values[p].subData()},e.exports=s},{"./Buffer":69}],71:[function(t,e,i){"use strict";function s(t,e){return function(){var i=t.apply(this,arguments);return e.apply(this,arguments),i}}function r(t,e){var i="body,html{background:#e3e3e3;font-family:monaco,monospace;font-size:14px;line-height:1.7em}#shaderReport{left:0;top:0;right:0;box-sizing:border-box;position:absolute;z-index:1000;color:#222;padding:15px;white-space:normal;list-style-type:none;margin:50px auto;max-width:1200px}#shaderReport li{background-color:#fff;margin:13px 0;box-shadow:0 1px 2px rgba(0,0,0,.15);padding:20px 30px;border-radius:2px;border-left:20px solid #e01111}span{color:#e01111;text-decoration:underline;font-weight:700}#shaderReport li p{padding:0;margin:0}#shaderReport li:nth-child(even){background-color:#f4f4f4}#shaderReport li p:first-child{margin-bottom:10px;color:#666}",s=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(s),s.textContent=i;var r=document.createElement("ul");r.setAttribute("id","shaderReport"),document.body.appendChild(r);for(var n,o=/ERROR: [\d]+:([\d]+): (.+)/gim,a=e.split("\n");null!=(n=o.exec(t));){n.index===o.lastIndex&&o.lastIndex++;var h=document.createElement("li"),u='<p><span>ERROR</span> "'+n[2]+'" in line '+n[1]+"</p>";u+="<p><b>"+a[n[1]-1].replace(/^[ \t]+/g,"")+"</b></p>",h.innerHTML=u,r.appendChild(h)}}e.exports=function(){return s(this.gl.compileShader,function(t){if(!this.getShaderParameter(t,this.COMPILE_STATUS)){var e=this.getShaderInfoLog(t),i=this.getShaderSource(t);r(e,i)}})}},{}],72:[function(t,e,i){"use strict";function s(t,e){this.gl=t,this.textureSlots=1,this.options=e||{},this.registeredMaterials={},this.flaggedUniforms=[],this.cachedUniforms={},this.uniformTypes=[],this.definitionVec4=[],this.definitionVec3=[],this.definitionFloat=[],this.applicationVec3=[],this.applicationVec4=[],this.applicationFloat=[],this.applicationVert=[],this.definitionVert=[],this.resetProgram()}var r=t("../utilities/clone"),n=t("../utilities/keyValueToArrays"),o=t("../webgl-shaders").vertex,a=t("../webgl-shaders").fragment,h=t("./Debug"),u=35633,l=35632,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p="precision mediump float;\n",d={undefined:"float ",1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 ",16:"mat4 "},f={u_baseColor:"vec4",u_normals:"vert",u_glossiness:"vec4",u_positionOffset:"vert"},m={vert:1,vec3:2,vec4:4,float:8},g=n({u_perspective:c,u_view:c,u_resolution:[0,0,0],u_transform:c,u_size:[1,1,1],u_time:0,u_opacity:1,u_metalness:0,u_glossiness:[0,0,0,0],u_baseColor:[1,1,1,1],u_normals:[1,1,1],u_positionOffset:[0,0,0],u_lightPosition:c,u_lightColor:c,u_ambientLight:[0,0,0],u_flatShading:0,u_numLights:0}),_=n({a_pos:[0,0,0],a_texCoord:[0,0],a_normals:[0,0,0]}),v=n({v_textureCoordinate:[0,0],v_normal:[0,0,0],v_position:[0,0,0],v_eyeVector:[0,0,0]});s.prototype.registerMaterial=function(t,e){var i=e,s=f[t],r=m[s];if((this.registeredMaterials[e._id]&r)===r)return this;var n;for(n in i.uniforms)-1===g.keys.indexOf(n)&&(g.keys.push(n),g.values.push(i.uniforms[n]));for(n in i.varyings)-1===v.keys.indexOf(n)&&(v.keys.push(n),v.values.push(i.varyings[n]));for(n in i.attributes)-1===_.keys.indexOf(n)&&(_.keys.push(n),_.values.push(i.attributes[n]));return this.registeredMaterials[e._id]|=r,"float"===s&&(this.definitionFloat.push(e.defines),this.definitionFloat.push("float fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationFloat.push("if (int(abs(ID)) == "+e._id+") return fa_"+e._id+"();")),"vec3"===s&&(this.definitionVec3.push(e.defines),this.definitionVec3.push("vec3 fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationVec3.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vec4"===s&&(this.definitionVec4.push(e.defines),this.definitionVec4.push("vec4 fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationVec4.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vert"===s&&(this.definitionVert.push(e.defines),this.definitionVert.push("vec3 fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationVert.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),this.resetProgram()},s.prototype.resetProgram=function(){var t,e,i,s,n,h,c=[p],f=[p];for(this.uniformLocations=[],this.attributeLocations={},this.uniformTypes={},this.attributeNames=r(_.keys),this.attributeValues=r(_.values),this.varyingNames=r(v.keys),this.varyingValues=r(v.values),this.uniformNames=r(g.keys),this.uniformValues=r(g.values),this.flaggedUniforms=[],this.cachedUniforms={},f.push("uniform sampler2D u_textures[7];\n"),this.applicationVert.length&&c.push("uniform sampler2D u_textures[7];\n"),h=0;h<this.uniformNames.length;h++)s=this.uniformNames[h],n=this.uniformValues[h],c.push("uniform "+d[n.length]+s+";\n"),f.push("uniform "+d[n.length]+s+";\n");for(h=0;h<this.attributeNames.length;h++)s=this.attributeNames[h],n=this.attributeValues[h],c.push("attribute "+d[n.length]+s+";\n");for(h=0;h<this.varyingNames.length;h++)s=this.varyingNames[h],n=this.varyingValues[h],c.push("varying "+d[n.length]+s+";\n"),f.push("varying "+d[n.length]+s+";\n");e=c.join("")+o.replace("#vert_definitions",this.definitionVert.join("\n")).replace("#vert_applications",this.applicationVert.join("\n")),t=f.join("")+a.replace("#vec3_definitions",this.definitionVec3.join("\n")).replace("#vec3_applications",this.applicationVec3.join("\n")).replace("#vec4_definitions",this.definitionVec4.join("\n")).replace("#vec4_applications",this.applicationVec4.join("\n")).replace("#float_definitions",this.definitionFloat.join("\n")).replace("#float_applications",this.applicationFloat.join("\n")),i=this.gl.createProgram(),this.gl.attachShader(i,this.compileShader(this.gl.createShader(u),e)),this.gl.attachShader(i,this.compileShader(this.gl.createShader(l),t)),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.program=i,this.gl.useProgram(this.program)):(console.error("link error: "+this.gl.getProgramInfoLog(i)),this.program=null),this.setUniforms(this.uniformNames,this.uniformValues);var m=this.gl.getUniformLocation(this.program,"u_textures[0]");return this.gl.uniform1iv(m,[0,1,2,3,4,5,6]),this},s.prototype.uniformIsCached=function(t,e){if(null==this.cachedUniforms[t])return e.length?this.cachedUniforms[t]=new Float32Array(e):this.cachedUniforms[t]=e,!1;if(e.length){for(var i=e.length;i--;)if(e[i]!==this.cachedUniforms[t][i]){for(i=e.length;i--;)this.cachedUniforms[t][i]=e[i];return!1}}else if(this.cachedUniforms[t]!==e)return this.cachedUniforms[t]=e,!1;return!0},s.prototype.setUniforms=function(t,e){var i,s,r,n,o,a=this.gl;if(!this.program)return this;for(n=t.length,o=0;n>o;o++)if(r=t[o],s=e[o],i=this.uniformLocations[r],null!==i&&(void 0===i&&(i=a.getUniformLocation(this.program,r),this.uniformLocations[r]=i),!this.uniformIsCached(r,s)))switch(this.uniformTypes[r]||(this.uniformTypes[r]=this.getUniformTypeFromValue(s)),this.uniformTypes[r]){case"uniform4fv":a.uniform4fv(i,s);break;case"uniform3fv":a.uniform3fv(i,s);break;case"uniform2fv":a.uniform2fv(i,s);break;case"uniform1fv":a.uniform1fv(i,s);break;case"uniform1f":a.uniform1f(i,s);break;case"uniformMatrix3fv":a.uniformMatrix3fv(i,!1,s);break;case"uniformMatrix4fv":a.uniformMatrix4fv(i,!1,s)}return this},s.prototype.getUniformTypeFromValue=function(t){if(Array.isArray(t)||t instanceof Float32Array)switch(t.length){case 1:return"uniform1fv";case 2:return"uniform2fv";case 3:return"uniform3fv";case 4:return"uniform4fv";case 9:return"uniformMatrix3fv";case 16:return"uniformMatrix4fv"}else if(!isNaN(parseFloat(t))&&isFinite(t))return"uniform1f";throw'cant load uniform "'+name+'" with value:'+JSON.stringify(t)},s.prototype.compileShader=function(t,e){var i=1;return this.options.debug&&(this.gl.compileShader=h.call(this)),this.gl.shaderSource(t,e),this.gl.compileShader(t),this.gl.getShaderParameter(t,this.gl.COMPILE_STATUS)||(console.error("compile error: "+this.gl.getShaderInfoLog(t)),console.error("1: "+e.replace(/\n/g,function(){return"\n"+(i+=1)+": "}))),t},e.exports=s},{"../utilities/clone":43,"../utilities/keyValueToArrays":44,"../webgl-shaders":79,"./Debug":71}],73:[function(t,e,i){"use strict";function s(t,e){e=e||{},this.id=t.createTexture(),this.width=e.width||0,this.height=e.height||0,this.mipmap=e.mipmap,this.format=e.format||"RGBA",this.type=e.type||"UNSIGNED_BYTE",this.gl=t,this.bind(),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipYWebgl||!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlphaWebgl||!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[e.magFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[e.minFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[e.wrapS]||t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[e.wrapT]||t.CLAMP_TO_EDGE)}s.prototype.bind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,this.id),this},s.prototype.unbind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,null),this},s.prototype.setImage=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.gl[this.format],this.gl[this.type],t),this.mipmap&&this.gl.generateMipmap(this.gl.TEXTURE_2D),this},s.prototype.setArray=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.width,this.height,0,this.gl[this.format],this.gl[this.type],t),this},s.prototype.readBack=function(t,e,i,s){var r,n=this.gl;t=t||0,e=e||0,i=i||this.width,s=s||this.height;var o=n.createFramebuffer();return n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.id,0),n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE&&(r=new Uint8Array(i*s*4),n.readPixels(t,e,i,s,n.RGBA,n.UNSIGNED_BYTE,r)),r},e.exports=s},{}],74:[function(t,e,i){"use strict";function s(t){this.registry=[],this._needsResample=[],this._activeTexture=0,this._boundTexture=null,this._checkerboard=o(),this.gl=t}function r(t,e){var i=("string"==typeof t?new Image:t)||{};return i.crossOrigin="anonymous",i.src||(i.src=t),i.complete?e(i):i.onload=function(){e(i)},i}var n=t("./Texture"),o=t("./createCheckerboard");s.prototype.update=function(t){for(var e=this.registry.length,i=1;e>i;i++){var s=this.registry[i];s&&s.isLoaded&&s.resampleRate&&(!s.lastResample||t-s.lastResample>s.resampleRate)&&(this._needsResample[s.id]||(this._needsResample[s.id]=!0,s.lastResample=t))}},s.prototype.register=function(t,e){var i,s=this,o=t.data,a=t.id,h=t.options||{},u=this.registry[a];return u||(u=new n(this.gl,h),u.setImage(this._checkerboard),i=this.registry[a]={resampleRate:h.resampleRate||null,lastResample:null,isLoaded:!1,texture:u,source:o,id:a,slot:e},Array.isArray(o)||o instanceof Uint8Array||o instanceof Float32Array?(this.bindTexture(a),u.setArray(o),i.isLoaded=!0):window&&o instanceof window.HTMLVideoElement?o.addEventListener("loadeddata",function(){s.bindTexture(a),u.setImage(o),i.isLoaded=!0,i.source=o}):"string"==typeof o&&r(o,function(t){s.bindTexture(a),u.setImage(t),i.isLoaded=!0,i.source=t})),a},s.prototype.bindTexture=function(t){var e=this.registry[t];this._activeTexture!==e.slot&&(this.gl.activeTexture(this.gl.TEXTURE0+e.slot),this._activeTexture=e.slot),this._boundTexture!==t&&(this._boundTexture=t,e.texture.bind()),this._needsResample[e.id]&&(e.texture.setImage(e.source),this._needsResample[e.id]=!1)},e.exports=s},{"./Texture":73,"./createCheckerboard":77}],75:[function(t,e,i){"use strict";function s(t,e){t.classList.add("famous-webgl-renderer"),
this.canvas=t,this.compositor=e;var i=this.gl=this.getWebGLContext(this.canvas);i.clearColor(0,0,0,0),i.polygonOffset(.1,.1),i.enable(i.POLYGON_OFFSET_FILL),i.enable(i.DEPTH_TEST),i.enable(i.BLEND),i.depthFunc(i.LEQUAL),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.CULL_FACE),i.cullFace(i.BACK),this.meshRegistry={},this.meshRegistryKeys=[],this.cutoutRegistry={},this.cutoutRegistryKeys=[],this.numLights=0,this.ambientLightColor=[0,0,0],this.lightRegistry={},this.lightRegistryKeys=[],this.lightPositions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.lightColors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.textureManager=new u(i),this.texCache={},this.bufferRegistry=new n(i),this.program=new r(i,{debug:!0}),this.state={boundArrayBuffer:null,boundElementBuffer:null,lastDrawn:null,enabledAttributes:{},enabledAttributesKeys:[]},this.resolutionName=["u_resolution"],this.resolutionValues=[],this.cachedSize=[],this.projectionTransform=[1,0,0,0,0,1,0,0,0,0,-1e-6,0,-1,1,0,1];var s=this.cutoutGeometry=new o;this.bufferRegistry.allocate(s.spec.id,"a_pos",s.spec.bufferValues[0],3),this.bufferRegistry.allocate(s.spec.id,"a_texCoord",s.spec.bufferValues[1],2),this.bufferRegistry.allocate(s.spec.id,"a_normals",s.spec.bufferValues[2],3),this.bufferRegistry.allocate(s.spec.id,"indices",s.spec.bufferValues[3],1)}var r=t("./Program"),n=t("./BufferRegistry"),o=t("../webgl-geometries/primitives/Plane"),a=t("./radixSort"),h=t("../utilities/keyValueToArrays"),u=t("./TextureManager"),l=t("./compileMaterial"),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p=h({u_numLights:0,u_ambientLight:new Array(3),u_lightPosition:new Array(3),u_lightColor:new Array(3),u_perspective:new Array(16),u_time:0,u_view:new Array(16)});s.prototype.getWebGLContext=function(t){for(var e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=null,s=0;s<e.length;s++){try{i=t.getContext(e[s])}catch(t){var r="Error creating WebGL context: "+t.prototype.toString();console.error(r)}if(i)break}return i?i:!1},s.prototype.createLight=function(t){return this.numLights++,this.lightRegistryKeys.push(t),this.lightRegistry[t]={color:[0,0,0],position:[0,0,0]},this.lightRegistry[t]},s.prototype.createMesh=function(t){this.meshRegistryKeys.push(t);var e=h({u_opacity:1,u_transform:c,u_size:[0,0,0],u_baseColor:[.5,.5,.5,1],u_positionOffset:[0,0,0],u_normals:[0,0,0],u_flatShading:0,u_glossiness:[0,0,0,0]});return this.meshRegistry[t]={depth:null,uniformKeys:e.keys,uniformValues:e.values,buffers:{},geometry:null,drawType:null,textures:[],visible:!0},this.meshRegistry[t]},s.prototype.setCutoutState=function(t,e){var i=this.getOrSetCutout(t);i.visible=e},s.prototype.getOrSetCutout=function(t){if(this.cutoutRegistry[t])return this.cutoutRegistry[t];var e=h({u_opacity:0,u_transform:c.slice(),u_size:[0,0,0],u_origin:[0,0,0],u_baseColor:[0,0,0,1]});return this.cutoutRegistryKeys.push(t),this.cutoutRegistry[t]={uniformKeys:e.keys,uniformValues:e.values,geometry:this.cutoutGeometry.spec.id,drawType:this.cutoutGeometry.spec.type,visible:!0},this.cutoutRegistry[t]},s.prototype.setMeshVisibility=function(t,e){var i=this.meshRegistry[t]||this.createMesh(t);i.visible=e},s.prototype.removeMesh=function(t){var e=this.meshRegistryKeys.indexOf(t);this.meshRegistryKeys.splice(e,1),this.meshRegistry[t]=null},s.prototype.setCutoutUniform=function(t,e,i){var s=this.getOrSetCutout(t),r=s.uniformKeys.indexOf(e);if(Array.isArray(i))for(var n=0,o=i.length;o>n;n++)s.uniformValues[r][n]=i[n];else s.uniformValues[r]=i},s.prototype.setMeshOptions=function(t,e){var i=this.meshRegistry[t]||this.createMesh(t);return i.options=e,this},s.prototype.setAmbientLightColor=function(t,e,i,s){return this.ambientLightColor[0]=e,this.ambientLightColor[1]=i,this.ambientLightColor[2]=s,this},s.prototype.setLightPosition=function(t,e,i,s){var r=this.lightRegistry[t]||this.createLight(t);return r.position[0]=e,r.position[1]=i,r.position[2]=s,this},s.prototype.setLightColor=function(t,e,i,s){var r=this.lightRegistry[t]||this.createLight(t);return r.color[0]=e,r.color[1]=i,r.color[2]=s,this},s.prototype.handleMaterialInput=function(t,e,i){var s=this.meshRegistry[t]||this.createMesh(t);i=l(i,s.textures.length),s.uniformValues[s.uniformKeys.indexOf(e)][0]=-i._id;for(var r=i.textures.length;r--;)s.textures.push(this.textureManager.register(i.textures[r],s.textures.length+r));return this.program.registerMaterial(e,i),this.updateSize()},s.prototype.setGeometry=function(t,e,i,s){var r=this.meshRegistry[t]||this.createMesh(t);return r.geometry=e,r.drawType=i,r.dynamic=s,this},s.prototype.setMeshUniform=function(t,e,i){var s=this.meshRegistry[t]||this.createMesh(t),r=s.uniformKeys.indexOf(e);-1===r?(s.uniformKeys.push(e),s.uniformValues.push(i)):s.uniformValues[r]=i},s.prototype.bufferData=function(t,e,i,s,r,n){return this.bufferRegistry.allocate(e,i,s,r,n),this},s.prototype.draw=function(t){var e=this.compositor.getTime();this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.textureManager.update(e),this.meshRegistryKeys=a(this.meshRegistryKeys,this.meshRegistry),this.setGlobalUniforms(t),this.drawCutouts(),this.drawMeshes()},s.prototype.drawMeshes=function(){for(var t,e,i=this.gl,s=0;s<this.meshRegistryKeys.length;s++)if(e=this.meshRegistry[this.meshRegistryKeys[s]],t=this.bufferRegistry.registry[e.geometry],e.visible&&(e.uniformValues[0]<1?(i.depthMask(!1),i.enable(i.BLEND)):(i.depthMask(!0),i.disable(i.BLEND)),t)){for(var r=e.textures.length;r--;)this.textureManager.bindTexture(e.textures[r]);e.options&&this.handleOptions(e.options,e),this.program.setUniforms(e.uniformKeys,e.uniformValues),this.drawBuffers(t,e.drawType,e.geometry),e.options&&this.resetOptions(e.options)}},s.prototype.drawCutouts=function(){var t,e,i=this.cutoutRegistryKeys.length;i&&(this.gl.enable(this.gl.BLEND),this.gl.depthMask(!0));for(var s=0;i>s;s++)t=this.cutoutRegistry[this.cutoutRegistryKeys[s]],e=this.bufferRegistry.registry[t.geometry],t.visible&&(this.program.setUniforms(t.uniformKeys,t.uniformValues),this.drawBuffers(e,t.drawType,t.geometry))},s.prototype.setGlobalUniforms=function(t){for(var e,i,s=0,r=this.lightRegistryKeys.length;r>s;s++)e=this.lightRegistry[this.lightRegistryKeys[s]],i=4*s,this.lightPositions[0+i]=e.position[0],this.lightPositions[1+i]=e.position[1],this.lightPositions[2+i]=e.position[2],this.lightColors[0+i]=e.color[0],this.lightColors[1+i]=e.color[1],this.lightColors[2+i]=e.color[2];p.values[0]=this.numLights,p.values[1]=this.ambientLightColor,p.values[2]=this.lightPositions,p.values[3]=this.lightColors,this.projectionTransform[0]=1/(.5*this.cachedSize[0]),this.projectionTransform[5]=-1/(.5*this.cachedSize[1]),this.projectionTransform[11]=t.perspectiveTransform[11],p.values[4]=this.projectionTransform,p.values[5]=.001*this.compositor.getTime(),p.values[6]=t.viewTransform,this.program.setUniforms(p.keys,p.values)},s.prototype.drawBuffers=function(t,e,i){var s,r,n,o,a,h,u,l,c=this.gl,p=0;for(h=t.keys.length,l=0;h>l;l++)s=t.keys[l],"indices"!==s?(r=this.program.attributeLocations[s],-1!==r&&(void 0!==r||(r=c.getAttribLocation(this.program.program,s),this.program.attributeLocations[s]=r,-1!==r))&&(this.state.enabledAttributes[s]||(c.enableVertexAttribArray(r),this.state.enabledAttributes[s]=!0,this.state.enabledAttributesKeys.push(s)),a=t.values[l],n=t.spacing[l],o=t.offset[l],p=t.length[l],this.state.boundArrayBuffer!==a&&(c.bindBuffer(a.target,a.buffer),this.state.boundArrayBuffer=a),this.state.lastDrawn!==i&&c.vertexAttribPointer(r,n,c.FLOAT,c.FALSE,0,4*o))):u=l;var d=this.state.enabledAttributesKeys.length;for(l=0;d>l;l++){var f=this.state.enabledAttributesKeys[l];this.state.enabledAttributes[f]&&-1===t.keys.indexOf(f)&&(c.disableVertexAttribArray(this.program.attributeLocations[f]),this.state.enabledAttributes[f]=!1)}p&&(void 0!==u?(a=t.values[u],o=t.offset[u],n=t.spacing[u],p=t.length[u],this.state.boundElementBuffer!==a&&(c.bindBuffer(a.target,a.buffer),this.state.boundElementBuffer=a),c.drawElements(c[e],p,c.UNSIGNED_SHORT,2*o)):c.drawArrays(c[e],0,p)),this.state.lastDrawn=i},s.prototype.updateSize=function(t){if(t){var e=window.devicePixelRatio||1,i=~~(t[0]*e),s=~~(t[1]*e);this.canvas.width=i,this.canvas.height=s,this.gl.viewport(0,0,i,s),this.cachedSize[0]=t[0],this.cachedSize[1]=t[1],this.cachedSize[2]=t[0]>t[1]?t[0]:t[1],this.resolutionValues[0]=this.cachedSize}return this.program.setUniforms(this.resolutionName,this.resolutionValues),this},s.prototype.handleOptions=function(t,e){var i=this.gl;t&&("double"===t.side&&(this.gl.cullFace(this.gl.FRONT),this.drawBuffers(this.bufferRegistry.registry[e.geometry],e.drawType,e.geometry),this.gl.cullFace(this.gl.BACK)),t.blending&&i.blendFunc(i.SRC_ALPHA,i.ONE),"back"===t.side&&i.cullFace(i.FRONT))},s.prototype.resetOptions=function(t){var e=this.gl;t&&(t.blending&&e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),"back"===t.side&&e.cullFace(e.BACK))},e.exports=s},{"../utilities/keyValueToArrays":44,"../webgl-geometries/primitives/Plane":58,"./BufferRegistry":70,"./Program":72,"./TextureManager":74,"./compileMaterial":76,"./radixSort":78}],76:[function(t,e,i){"use strict";function s(t,e){var i="",s={},u={},c={},p=[],d=[];return r(t,function(t,r){if(t.chunk){var f=l[n(t)],m=a(t),g=o(t.chunk.glsl,t.inputs,d.length+e);i+=f+m+" = "+g+"\n ",t.uniforms&&h(s,t.uniforms),t.varyings&&h(u,t.varyings),t.attributes&&h(c,t.attributes),t.chunk.defines&&p.push(t.chunk.defines),t.texture&&d.push(t.texture)}}),{_id:t._id,glsl:i+"return "+a(t)+";",defines:p.join("\n"),uniforms:s,varyings:u,attributes:c,textures:d}}function r(t,e){for(var i=t.inputs,s=i&&i.length,n=-1;++n<s;)r(i[n],e);return e(t),t}function n(t){if("number"==typeof t)return 1;if(Array.isArray(t))return t.length;var e=t.chunk.output;if("number"==typeof e)return e;var i=t.inputs.map(function(t){return n(t)}).join(",");return e[i]}function o(t,e,i){return t.replace(/%\d/g,function(t){return a(e[t[1]-1])}).replace(/\$TEXTURE/,"u_textures["+i+"]")}function a(t){return Array.isArray(t)?u(t):"object"==typeof t?"fa_"+t._id:t.toFixed(6)}function h(t,e){for(var i in e)t[i]=e[i]}function u(t){var e=t.length;return"vec"+e+"("+t.join(",")+")"}var l={1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 "};e.exports=s},{}],77:[function(t,e,i){"use strict";function s(){var t=document.createElement("canvas").getContext("2d");t.canvas.width=t.canvas.height=128;for(var e=0;e<t.canvas.height;e+=16)for(var i=0;i<t.canvas.width;i+=16)t.fillStyle=16&(i^e)?"#FFF":"#DDD",t.fillRect(i,e,16,16);return t.canvas}e.exports=s},{}],78:[function(t,e,i){"use strict";function s(t,e,i){var s=t[i],r=e[s];return(r.depth?r.depth:e[s].uniformValues[1][14])+_}function r(t,e,i,s){var r=t[i];return e[r].depth=a(s)-_,r}function n(t,e,i){e[t[i]].depth=null}function o(t){return y[0]=t,b[0]}function a(t){return b[0]=t,y[0]}function h(t,e){var i,a,h,d,_,v,y,b,w,x,T,C=0,E=[];for(m=32/u+.999999999999999|0,i=0,d=l*m;d>i;i++)p[i]=0;for(i=0,d=t.length;d>i;i++){for(_=o(s(t,e,i)),_^=_>>31|2147483648,a=0,h=0;g>a;a+=l,h+=u)p[a+(_>>>h&c)]++;p[a+(_>>>h&f)]++}for(a=0;g>=a;a+=l)for(b=a,w=0;a+l>b;b++)x=p[b]+w,p[b]=w-1,w=x;if(--m){for(i=0,d=t.length;d>i;i++)_=o(s(t,e,i)),E[++p[_&c]]=r(t,e,i,_^=_>>31|2147483648);for(y=E,E=t,t=y;++C<m;){for(i=0,d=t.length,v=C*l,T=C*u;d>i;i++)_=o(s(t,e,i)),E[++p[v+(_>>>T&c)]]=t[i];y=E,E=t,t=y}}for(i=0,d=t.length,v=C*l,T=C*u;d>i;i++)_=o(s(t,e,i)),E[++p[v+(_>>>T&f)]]=r(t,e,i,_^(~_>>31|2147483648)),n(t,e,i);return E}var u=11,l=1<<u,c=l-1,p=new Array(l*Math.ceil(64/u)),d=1<<31%u,f=(d<<1)-1,m=32/u+.999999999999999|0,g=l*(m-1),_=Math.pow(20,6),v=new ArrayBuffer(4),y=new Float32Array(v,0,1),b=new Int32Array(v,0,1);e.exports=h},{}],79:[function(t,e,i){"use strict";var s=(t("glslify"),t("glslify/simple-adapter.js")("\n#define GLSLIFY 1\n\nmat3 a_x_getNormalMatrix(in mat4 t) {\n  mat3 matNorm;\n  mat4 a = t;\n  float a00 = a[0][0], a01 = a[0][1], a02 = a[0][2], a03 = a[0][3], a10 = a[1][0], a11 = a[1][1], a12 = a[1][2], a13 = a[1][3], a20 = a[2][0], a21 = a[2][1], a22 = a[2][2], a23 = a[2][3], a30 = a[3][0], a31 = a[3][1], a32 = a[3][2], a33 = a[3][3], b00 = a00 * a11 - a01 * a10, b01 = a00 * a12 - a02 * a10, b02 = a00 * a13 - a03 * a10, b03 = a01 * a12 - a02 * a11, b04 = a01 * a13 - a03 * a11, b05 = a02 * a13 - a03 * a12, b06 = a20 * a31 - a21 * a30, b07 = a20 * a32 - a22 * a30, b08 = a20 * a33 - a23 * a30, b09 = a21 * a32 - a22 * a31, b10 = a21 * a33 - a23 * a31, b11 = a22 * a33 - a23 * a32, det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  det = 1.0 / det;\n  matNorm[0][0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  matNorm[0][1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  matNorm[0][2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  matNorm[1][0] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  matNorm[1][1] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  matNorm[1][2] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  matNorm[2][0] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  matNorm[2][1] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  matNorm[2][2] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return matNorm;\n}\nfloat b_x_inverse(float m) {\n  return 1.0 / m;\n}\nmat2 b_x_inverse(mat2 m) {\n  return mat2(m[1][1], -m[0][1], -m[1][0], m[0][0]) / (m[0][0] * m[1][1] - m[0][1] * m[1][0]);\n}\nmat3 b_x_inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11), b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10), b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\nmat4 b_x_inverse(mat4 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3], a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3], a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3], a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3], b00 = a00 * a11 - a01 * a10, b01 = a00 * a12 - a02 * a10, b02 = a00 * a13 - a03 * a10, b03 = a01 * a12 - a02 * a11, b04 = a01 * a13 - a03 * a11, b05 = a02 * a13 - a03 * a12, b06 = a20 * a31 - a21 * a30, b07 = a20 * a32 - a22 * a30, b08 = a20 * a33 - a23 * a30, b09 = a21 * a32 - a22 * a31, b10 = a21 * a33 - a23 * a31, b11 = a22 * a33 - a23 * a32, det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  return mat4(a11 * b11 - a12 * b10 + a13 * b09, a02 * b10 - a01 * b11 - a03 * b09, a31 * b05 - a32 * b04 + a33 * b03, a22 * b04 - a21 * b05 - a23 * b03, a12 * b08 - a10 * b11 - a13 * b07, a00 * b11 - a02 * b08 + a03 * b07, a32 * b02 - a30 * b05 - a33 * b01, a20 * b05 - a22 * b02 + a23 * b01, a10 * b10 - a11 * b08 + a13 * b06, a01 * b08 - a00 * b10 - a03 * b06, a30 * b04 - a31 * b02 + a33 * b00, a21 * b02 - a20 * b04 - a23 * b00, a11 * b07 - a10 * b09 - a12 * b06, a00 * b09 - a01 * b07 + a02 * b06, a31 * b01 - a30 * b03 - a32 * b00, a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\nfloat c_x_transpose(float m) {\n  return m;\n}\nmat2 c_x_transpose(mat2 m) {\n  return mat2(m[0][0], m[1][0], m[0][1], m[1][1]);\n}\nmat3 c_x_transpose(mat3 m) {\n  return mat3(m[0][0], m[1][0], m[2][0], m[0][1], m[1][1], m[2][1], m[0][2], m[1][2], m[2][2]);\n}\nmat4 c_x_transpose(mat4 m) {\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0], m[0][1], m[1][1], m[2][1], m[3][1], m[0][2], m[1][2], m[2][2], m[3][2], m[0][3], m[1][3], m[2][3], m[3][3]);\n}\nvec4 applyTransform(vec4 pos) {\n  mat4 MVMatrix = u_view * u_transform;\n  pos.x += 1.0;\n  pos.y -= 1.0;\n  pos.xyz *= u_size * 0.5;\n  pos.y *= -1.0;\n  v_position = (MVMatrix * pos).xyz;\n  v_eyeVector = (u_resolution * 0.5) - v_position;\n  pos = u_perspective * MVMatrix * pos;\n  return pos;\n}\n#vert_definitions\n\nvec3 calculateOffset(vec3 ID) {\n  \n  #vert_applications\n  return vec3(0.0);\n}\nvoid main() {\n  v_textureCoordinate = a_texCoord;\n  vec3 invertedNormals = a_normals + (u_normals.x < 0.0 ? calculateOffset(u_normals) * 2.0 - 1.0 : vec3(0.0));\n  invertedNormals.y *= -1.0;\n  v_normal = c_x_transpose(mat3(b_x_inverse(u_transform))) * invertedNormals;\n  vec3 offsetPos = a_pos + calculateOffset(u_positionOffset);\n  gl_Position = applyTransform(vec4(offsetPos, 1.0));\n}","\n#define GLSLIFY 1\n\n#float_definitions\n\nfloat a_x_applyMaterial(float ID) {\n  \n  #float_applications\n  return 1.;\n}\n#vec3_definitions\n\nvec3 a_x_applyMaterial(vec3 ID) {\n  \n  #vec3_applications\n  return vec3(0);\n}\n#vec4_definitions\n\nvec4 a_x_applyMaterial(vec4 ID) {\n  \n  #vec4_applications\n  return vec4(0);\n}\nvec4 b_x_applyLight(in vec4 baseColor, in vec3 normal, in vec4 glossiness) {\n  int numLights = int(u_numLights);\n  vec3 ambientColor = u_ambientLight * baseColor.rgb;\n  vec3 eyeVector = normalize(v_eyeVector);\n  vec3 diffuse = vec3(0.0);\n  bool hasGlossiness = glossiness.a > 0.0;\n  bool hasSpecularColor = length(glossiness.rgb) > 0.0;\n  for(int i = 0; i < 4; i++) {\n    if(i >= numLights)\n      break;\n    vec3 lightDirection = normalize(u_lightPosition[i].xyz - v_position);\n    float lambertian = max(dot(lightDirection, normal), 0.0);\n    if(lambertian > 0.0) {\n      diffuse += u_lightColor[i].rgb * baseColor.rgb * lambertian;\n      if(hasGlossiness) {\n        vec3 halfVector = normalize(lightDirection + eyeVector);\n        float specularWeight = pow(max(dot(halfVector, normal), 0.0), glossiness.a);\n        vec3 specularColor = hasSpecularColor ? glossiness.rgb : u_lightColor[i].rgb;\n        diffuse += specularColor * specularWeight * lambertian;\n      }\n    }\n  }\n  return vec4(ambientColor + diffuse, baseColor.a);\n}\nvoid main() {\n  vec4 material = u_baseColor.r >= 0.0 ? u_baseColor : a_x_applyMaterial(u_baseColor);\n  bool lightsEnabled = (u_flatShading == 0.0) && (u_numLights > 0.0 || length(u_ambientLight) > 0.0);\n  vec3 normal = normalize(v_normal);\n  vec4 glossiness = u_glossiness.x < 0.0 ? a_x_applyMaterial(u_glossiness) : u_glossiness;\n  vec4 color = lightsEnabled ? b_x_applyLight(material, normalize(v_normal), glossiness) : material;\n  gl_FragColor = color;\n  gl_FragColor.a *= u_opacity;\n}",[],[]));e.exports=s},{glslify:30,"glslify/simple-adapter.js":31}],80:[function(t,e,i){"use strict";function s(t){return t*(180/Math.PI)}function r(t){return t*Math.PI/180}function n(t){return t=360+s(t),t>=360?t-=360*Math.floor(t/360):-360>=t&&(t+=360*Math.floor(Math.abs(t)/360)),r(t)}function o(t,e){l(),tt.hideContent(),N.activeMarker&&N.activeMarker===t?"function"==typeof e&&(K=!1,e()):Z.start("setY",r(N[t].node.angle),1e3,"inOutCubic",function(){"function"==typeof e&&(K=!0,e())})}function a(t,e,i,s){document.querySelector("[data-target-project='"+t+"."+e+"']").setAttribute(s||"data-active",i),"false"===i&&!s&&q.activeDot&&(q.activeDot=null)}function h(t,e){N.activeMarker=t,q.activeDot=q[t][e],a(t,e,"true")}function u(t,e){var i=q[t][e];o(t,function(){j||q.activeDot===e||(i.setActive(!0),h(t,e),tt.show(V[e]))}),j||h(t,e)}function l(){q.activeDot&&(q.activeDot.setActive(!1,!0),a(q.activeDot.targetId,q.activeDot.projectDotId,"false"))}function c(t){H=n(t)}function p(t){for(var e=0;e<t.length;e++){var i=e-2;(2===e||e>2&&i%6===0)&&(t[e]=t[e-1])}return t}function d(t){return{start:function(e,i,n,o,a){var h=s(i);t.halt(),Math.abs(h-W)>=180&&(h>=W?i=r(-(360-h)):W>=h&&(i=r(360+h))),j=!0,J.setY(H,{duration:0}),t[e](i,{duration:n,curve:o||"linear"},function(){W=h,t[e](r(h)),$.destinationX=$.rotationX=r(h),j=!1,"function"==typeof a&&a()})}}}function f(t,e,i,r){var n,o,a=Y.addChild().setRotation(Math.PI/2,0,0).setProportionalSize(.012,.012,.3).setAlign(t[0],t[1],t[2]),h=new M(a),u=new E;if(h.setGeometry(u).setBaseColor(new A("#df4a00")).setFlatShading(!0),i){var l=Math.abs(t[0]-.5),p=t[2],d=Math.sqrt(Math.pow(l,2)+Math.pow(p,2)),f=90,m=s(Math.acos((Math.pow(l,2)+Math.pow(d,2)-Math.pow(p,2))/(2*l*d))),g=f-m;a.circleAngle=g,t[2]<0&&(a.circleAngle=90+(90-g)),t[0]>=.5&&(a.circleAngle=180+g),t[0]>=.5&&t[2]>0&&(a.circleAngle=270+(90-g)),a.angle=r}var _=a.addChild().setAlign(.5,.5,1).setRotation(-(Math.PI/2),0,0).setSizeMode(1,1,1).setAbsoluteSize(240,30),v=new U(_,{content:"<span>"+e+"</span>",classes:["landscape-marker"]}),y=a.addComponent({onUpdate:function(t){j&&c(J.getY()),_.setRotation(-(Math.PI/2),-H,0),i&&(n=a.circleAngle-s(H),-180>n&&(n+=360),n>=180&&(n=360-n),o=1-(Math.abs(n)-80)/40,0>o&&(o=0),o>1&&(o=1),v.setProperty("opacity",o),a.visibleOpacity=o),b.step(t),a.requestUpdateOnNextTick(y)},onSizeChange:function(t){var e,i=4.7*t[2],s=t[2]/2.5,r=(90-t[2])/54;0>=r?r=1:r+=1,i*=r,s*=r,document.querySelector("#famous-fog").style.height=100/r+"px",_.setAbsoluteSize(i,s),v.setProperty("font-size",e+"vmin")}});return a.requestUpdate(y),a}function m(t,e,i,s,n){var o=.08,h=t.position.concat(),l=h.concat();s=s.split(".");var c=s[0],p=s[1];G&&(e[1]-=.03),h[0]=h[0]-o+e[0],h[1]=h[1]+2*o+e[1],h[2]=h[2]-o/2+e[2];var d=Y.addChild().setProportionalSize(o,o,o).setAlign(h[0],h[1],h[2]);switch(t.id){case"webdev":d.setRotation(r(90),r(-i),0);break;case"ui":d.setRotation(r(-i),0,0);break;case"comps":d.setRotation(r(90),r(i),0);break;case"gamedev":d.setRotation(r(i),0,0)}d.torusMesh=new M(d);var f=new R;d.torusMesh.setGeometry(f).setBaseColor(new A(G?"#faad02":"#2c2017")).setFlatShading(!0),d.circleNode=d.addChild(),d.circleNode.setOpacity(.7);var m=new M(d.circleNode),g=new S;m.setGeometry(g).setBaseColor(new A("#df4a00")).setFlatShading(!0),d.circleNode.hide(),d.domElm=new U(d,{properties:{cursor:"pointer"}}),d.landmarker=t,d.targetId=c,d.projectDotId=p,d.isUserInteractionAllowed=function(){return!j&&!$.isMouseDown&&d.landmarker.node.visibleOpacity>=.8},d.setActive=function(t,e){t?(d.torusMesh.setBaseColor(new A("#df4a00")),d.circleNode.show()):(!q.activeDot||q.activeDot.projectDotId!==p||e)&&(d.torusMesh.setBaseColor(new A(G?"#faad02":"#2c2017")),d.circleNode.hide())},d.addUIEvent("mouseover"),d.addUIEvent("mouseleave");var _=d.addComponent({onReceive:function(t,e){if(d.isUserInteractionAllowed())switch(e.type){case"mouseover":d.setActive(!0),a(c,p,"true","data-hover");break;case"mouseleave":d.setActive(!1),a(c,p,"false","data-hover")}else e.stopPropagation()},onUpdate:function(){d.domElm.setProperty("display",d.isUserInteractionAllowed()?"block":"none"),d.domElm.setProperty("cursor",d.landmarker.node.visibleOpacity>=.8?"pointer":"default"),d.requestUpdateOnNextTick(_)}});d.requestUpdate(_);var v=new L(d);if(v.on("tap",function(t,e){d.isUserInteractionAllowed()&&(u(c,p),a(c,p,"false","data-hover"))}),n){d.updateAlign=function(t,e,i){var s=l[0]-o+t,r=l[1]+2*o+e,n=l[2]-o/2+i;d.setAlign(s,r,n)};var y=document.createElement("input");y.setAttribute("style","position:absolute;padding:7px;font-size:26px;background:black;color:white;float:left;clear:both;z-index:9999;"),y.value=e[0]+", "+e[1].toFixed(2)+", "+e[2],document.body.appendChild(y),y.addEventListener("keyup",function(){var t=this.value.split(", ");d.updateAlign(Number(t[0]),Number(t[1]),Number(t[2]))})}return d}function g(){f([.5,-1.4,-.09],"JavaScript"),N.webdev.node=f(N.webdev.position,"Web Development",!0,78),N.ui.node=f(N.ui.position,"User Interface Design",!0,172.5),N.comps.node=f(N.comps.position,"Comparisons",!0,249.3),N.gamedev.node=f(N.gamedev.position,"Game Development",!0,347.5),$.setRotation(N.webdev.node.angle,"webdev")}function _(){q.webdev.angular2seed=m(N.webdev,[.24,-.15,-.35],60,"webdev.angular2seed"),q.webdev.pixelzoomer=m(N.webdev,[.16,-.1,-.18],40,"webdev.pixelzoomer"),q.webdev.autoreload=m(N.webdev,[-.1,.12,.15],39,"webdev.autoreload"),q.webdev.canvasplayground=m(N.webdev,[.05,.1,-.3],35,"webdev.canvasplayground"),q.webdev.htmlivecode=m(N.webdev,[-.05,.135,-.47],38,"webdev.htmlivecode"),q.webdev.simplewebserver=m(N.webdev,[-.15,.15,-.1],35,"webdev.simplewebserver"),q.webdev.karmahtmlreporter=m(N.webdev,[-.26,.37,-.54],33,"webdev.karmahtmlreporter"),q.webdev.lazyreload=m(N.webdev,[-.5,.35,0],35,"webdev.lazyreload"),q.ui.coresheet=m(N.ui,[.19,-.08,-.06],50,"ui.coresheet"),q.ui.tooltip=m(N.ui,[.25,.02,-.18],50,"ui.tooltip"),q.ui.customscrollbar=m(N.ui,[-.25,.2,.1],50,"ui.customscrollbar"),q.ui.jqhovercrossfade=m(N.ui,[.4,.17,-.3],50,"ui.jqhovercrossfade"),q.comps.mobileappmatrix=m(N.comps,[.18,.04,-.1],30,"comps.mobileappmatrix"),q.comps.javascriptmatrix=m(N.comps,[.3,.06,.25],35,"comps.javascriptmatrix"),q.gamedev.platforms=m(N.gamedev,[-.12,-.1,.07],40,"gamedev.platforms"),q.gamedev.threebasicgame=m(N.gamedev,[-.01,.05,.14],30,"gamedev.threebasicgame")}function v(){var t=F.addChild().setAlign(.5,.5,.5).setPosition(0,0,0),e=(new x(t).setColor(new A("#0d0a06")),F.addChild().setAlign(.5,-2.5,.5).setPosition(0,0,300)),i=(new T(e).setColor(new A("#f79e02")),F.addChild().setAlign(.5,-2.5,.5).setPosition(0,0,900)),s=(new T(i).setColor(new A("#76120f")),F.addChild().setAlign(5.5,-15.5,.5).setPosition(0,0,100)),r=(new T(s).setColor(new A("#2c2017")),F.addChild().setAlign(.5,.5,.5).setPosition(-1e4,0,0));new T(r).setColor(new A("#2c2017"))}function y(){function t(){X=!0,tt.show(V.info)}$.bindEvents(),tt.bindEvents(),document.addEventListener("touchmove",function(t){t.preventDefault()}),Array.prototype.forEach.call(document.querySelectorAll("#nav-container .head-link"),function(t){var e=t.getAttribute("data-target");t.addEventListener("click",function(){o(e),tt.hide(),N.activeMarker=e})}),Array.prototype.forEach.call(document.querySelectorAll("#nav-container .dot-link"),function(t){var e=t.getAttribute("data-target-project").split("."),i=e[0],s=e[1],r=q[i][s];t.addEventListener("click",function(){q.activeDot&&q.activeDot.projectDotId===s||(tt.reset(),u(i,s))}),t.addEventListener("mouseover",function(){r.setActive(!0)}),t.addEventListener("mouseleave",function(){r.setActive(!1)})}),document.querySelector("#infolink").addEventListener("click",function(){X||(Q?tt.hide(t):tt.reset(t))})}var b=t("famous/core/FamousEngine"),w=t("famous/webgl-geometries/OBJLoader"),x=t("famous/webgl-renderables/lights/AmbientLight"),T=t("famous/webgl-renderables/lights/PointLight"),C=t("famous/webgl-geometries/Geometry"),E=t("famous/webgl-geometries/primitives/Cylinder"),S=t("famous/webgl-geometries/primitives/Circle"),R=t("famous/webgl-geometries/primitives/Torus"),M=(t("famous/webgl-materials/Material"),t("famous/webgl-renderables/Mesh")),A=t("famous/utilities/Color"),z=t("famous/components/Camera"),O=(t("famous/components/Position"),t("famous/components/Rotation")),U=(t("famous/transitions/Transitionable"),t("famous/dom-renderables/DOMElement")),L=t("famous/components/GestureHandler"),k=t("famous/webgl-renderers/WebGLRenderer"),I=t("famous/renderers/Context"),D=t("famous/utilities/keyValueToArrays"),P=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];I.prototype.initWebGL=function(){this.canvas=document.createElement("canvas"),this._rootEl.insertBefore(this.canvas,this._rootEl.firstChild),this.WebGLRenderer=new k(this.canvas,this._compositor),this.updateSize()},k.prototype.getOrSetCutout=function(t){if(this.cutoutRegistry[t])return this.cutoutRegistry[t];var e=D({u_opacity:0,u_transform:P.slice(),u_size:[0,0,0],u_origin:[0,0,0],u_baseColor:[0,0,0,1]});return this.cutoutRegistryKeys.push(t),this.cutoutRegistry[t]={uniformKeys:e.keys,uniformValues:e.values,geometry:this.cutoutGeometry.spec.id,drawType:this.cutoutGeometry.spec.type,visible:!1},this.cutoutRegistry[t]};var G=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),F=b.createScene("#famous-content"),N=(new z(F).setDepth(800),{activeMarker:null,webdev:{id:"webdev",node:null,position:[-.32,-.58,.17]},ui:{id:"ui",node:null,position:[.35,-.55,-1.1]},comps:{id:"comps",node:null,position:[1.4,-.5,-.35]},gamedev:{id:"gamedev",node:null,position:[.75,-.6,1.15]}}),q={activeDot:null,webdev:{},ui:{},comps:{},gamedev:{}},V={info:{title:"Web Development Tools",subtitle:"Info",img:"info.png",text:"This website is a graphical representation of the complete web development tool collection of <a href='http://matthiasschuetz.com/en'>Matthias Schütz</a>. There are descriptions and website links for each tool. The website itself is a 3D WebGL application and relies on the <a href='http://famous.org/'>Famous Engine</a>.",hideLink:!0},angular2seed:{title:"Angular 2 Seed",subtitle:"JavaScript boilerplate",img:"angular2seed.png",text:"The <strong>Angular 2 Seed</strong> is a starter project for Angular 2 apps. It relies on TypeScript, SystemJS, Gulp and Sass. The project comes with various features you may need to build a typical single page application (SPA): a routing concept, login and dashboard view components, error page handling, a directive (form inputs), a service (authorization) and a pipe (determine the active route). It uses es6-shim, Reflect, Rx.js and Zone.js.",link:"http://matthiasschuetz.com/angular2-seed/"},pixelzoomer:{title:"PixelZoomer",subtitle:"Software application",img:"pixelzoomer.png",text:"<strong>PixelZoomer</strong> is a Windows<sup>&reg;</sup>-based application for web developers which allows for zooming into websites. The core features are characterized by tools for pixel perfect measuring of distances and picking colors (HEX codes) with an eye dropper. The program creates a desktop screenshot automatically and shows real pixels that are not smoothed. The application is the successor of the same-named Firefox extension.",link:"http://pixelzoomer.com/"},autoreload:{title:"AutoReload",subtitle:"Node.js Script",img:"autoreload.png",text:"<strong>AutoReload</strong> is a small Node.js server application which relies on the popular <a href='https://github.com/senchalabs/connect'>connect framework</a> and uses <a href='https://www.npmjs.com/package/connect-livereload'>connect-livereload</a>, <a href='https://www.npmjs.com/package/serve-static'>serve-static</a>, <a href='https://www.npmjs.com/package/tiny-lr'>tiny-lr</a> and <a href='https://www.npmjs.com/package/chokidar'>chokidar</a> to run a local web server. It watches for file changes inside a directory and automatically refreshes the browser window when a file was changed. You simply run it from the console and set a directory path which is set as root directory of the local server. Thereby you can develop your web application by just surfing to <em>http://localhost:3000</em> for example.",link:"http://matthiasschuetz.com/nodejs-snippets/#autoreload"},canvasplayground:{title:"Canvas Animation Playground",subtitle:"Online Code Editor",img:"canvasplayground.png",text:"The <strong>Canvas Animation Playground</strong> is an experimental online editor for creating HTML5 canvas animations. It is based on <a href='http://htmlivecode.com/'>HTMLiveCode</a> and allows you to type in JavaScript code that will be directly interpreted for a <em>&lt;canvas&gt;</em> box on the right side. The function <em>CanvasAnimationLoop()</em> gets called on every browser frame via <em>requestAnimationFrame</em>. Each animation can be exported as a stand-alone HTML file.",link:"http://htmlivecode.com/canvas-animation-playground/"},htmlivecode:{title:"HTMLiveCode",subtitle:"Online Code Editor",img:"htmlivecode.png",text:"<strong>HTMLiveCode</strong> is a basic online editor that is built on top of HTML, CSS and JavaScript. It allows real-time code editing inside the browser window and directly displays the HTML result on the right side. It relies on <a href='https://codemirror.net/'>CodeMirror</a> and was made for the editing of these languages. Thereby it can be used for rapid prototyping. The editor can be customized in its appearance so there are themes and some other editor options (font size, gutter, word wrap).",link:"http://htmlivecode.com/"},simplewebserver:{title:"SimpleWebServer",subtitle:"Node.js Script",img:"simplewebserver.png",text:"<strong>SimpleWebServer</strong> represents a static Node.js web server script. It is based on <a href='https://github.com/senchalabs/connect'>connect</a> and <a href='https://www.npmjs.com/package/serve-static'>serve-static</a> and very basic (5 lines of code). It's meant to be an example of how to use a local file path as web server root and serve static files like HTML, CSS and JS. After running the script from the command prompt, you can simply surf to <em>http://localhost:3000</em> to see the result.",
link:"http://matthiasschuetz.com/nodejs-snippets/#simplewebserver"},karmahtmlreporter:{title:"Karma HTMLfile reporter",subtitle:"Node.js Module",img:"karmahtmlfilereporter.png",text:"THe <strong>Karma HTMLfile reporter</strong> is a Node.js module and represents plugin for the <a href='http://karma-runner.github.io/'>Karma Test Runner</a>. By adding this reporter to your Karma configuration, unit test results will be exported as a styled HTML file (separate colored rows for pass/skip/fail). For each test browser, a separate table is generated. The plugin is based on the <a href='https://github.com/karma-runner/karma-junit-reporter'>karma-junit-reporter plugin</a>. It allows you to specify the output HTML file, a page title and a sub page title.",link:"https://github.com/matthias-schuetz/karma-htmlfile-reporter"},lazyreload:{title:"LazyReload",subtitle:"JavaScript Library",img:"lazyreload.png",text:"<strong>LazyReload</strong> is a small script for local web development. It monitors changes on predefined files and refreshes the browser window automatically whenever one of these files was changed. It uses XMLHttpRequests and a certain interval to read out the latest information of the monitored files. The determination of a changed file can be set using different methods (header information, content length, content).",link:"https://github.com/matthias-schuetz/LazyReload"},coresheet:{title:"CoreSheet",subtitle:"CSS Framework",img:"coresheet.png",text:"<strong>CoreSheet</strong> is a solid open source Sass/CSS3 framework for front-end web developers. It is completely customizable and comes with a set of styled HTML components. It provides a percentage-based responsive grid system and gives developers full control over the design settings. The framework can help you to realize dynamic HTML pages for smartphones, tablets and desktop PCs.",link:"http://coresheet.net"},tooltip:{title:"Tooltip.js",subtitle:"JavaScript Library",img:"tooltipjs.png",text:"<strong>Tooltip.js</strong> is a basic mouseover tooltip script and is meant to be an example of how HTML5 <em>data</em> attributes can be used to add a tooltip functionality to DOM elements. The tooltips are created by reading out the <em>title</em> attribute and can be configured by passing a JSON option string to the <em>data</em> attribute. The tooltip's appearance is fully customizable via CSS.",link:"http://matthias-schuetz.js.org/tooltip.js/"},customscrollbar:{title:"CustomScrollbar.js",subtitle:"JavaScript Library",img:"customscrollbarjs.png",text:"<strong>CustomScrollbar.js</strong> is a small script for custom styled browser scrollbars. It allows you to style the vertical scrollbar of the entire web page by using CSS. You can adjust the appearance of the scrollbar background and the scroll thumbs that include arrows for scrolling up and down. The library makes use  of browsers' default scroll behavior and comes with cross-browser and multi-system support.",link:"http://matthias-schuetz.js.org/customscrollbar.js/"},jqhovercrossfade:{title:"jQuery HoverCrossfade",subtitle:"jQuery Plugin",img:"jqhovercrossfade.jpg",text:"The <strong>jQuery HoverCrossfade</strong> plugin for jQuery is made for changing default hover effects of links or buttons. It's based on the <em>background-image</em> attribute and simply crossfades between two images. When applying the plugin to an element, two additional containers are created in order to make the effect work. One container contains the hover image while the other element acts as clickable area. You can set the delays for fading in and out in the options of the plugin. The plugin was made under the condition that if JavaScript is turned off, the usual CSS hover effects will show up.",link:"https://github.com/matthias-schuetz/HoverCrossfade"},mobileappmatrix:{title:"Mobile App Framework Matrix",subtitle:"Comparison Website",img:"mobileappmatrix.jpg",text:"The <strong>Mobile App Framework Matrix</strong> represents a comparison and documentation of current technologies for building native iOS and Android apps with a single JavaScript code base: this is possible by using certain frameworks which provide cross-platform support by using HTML or by providing a dynamic runtime. Web developers shall get a picture of the available technologies and their drawbacks. Since cross-platform mobile apps have different requirments, not each solution is suitable for every scenario.",link:"http://matthiasschuetz.com/mobile-app-framework-matrix/"},javascriptmatrix:{title:"JavaScript Framework Matrix",subtitle:"Comparison Website",img:"javascriptmatrix.jpg",text:"The <strong>JavaScript Framework Matrix</strong> is meant to give web developers an overview of popular JavaScript frameworks and their functions. The matrix contains various examples for each framework and every code snippet contains links to the official documentation. The choice of a framework depends on many factors and can't be made of the website only. The matrix shall solely demonstrate the different API styles and functionalities of the JavaScript libraries.",link:"http://matthiasschuetz.com/javascript-framework-matrix/en/"},platforms:{title:"Platforms",subtitle:"JavaScript/WebGL Game",img:"platforms.png",text:"<strong>Platforms</strong> s a small WebGL game where your task is to jump from platform to platform without falling. You can get small boosts if you land on 10 platforms steadily in a short amount of time. The game is based on <a href='http://matthiasschuetz.com/three-basicthirdpersongame/'>THREE.BasicThirdPersonGame</a>. The source code was made open source to give game developers and users of THREE.BasicThirdPersonGame an insight of how a final game project could look like. So there's no documentation for the game itself but the code is commented at some places.",link:"http://matthiasschuetz.com/webgl-platforms-game/"},threebasicgame:{title:"THREE.BasicThirdPersonGame",subtitle:"JavaScript/WebGL Framework",img:"threebasicthirdpersongame.jpg",text:"<strong>THREE.BasicThirdPersonGame</strong> is a free open source JavaScript micro-framework for 3D WebGL games based on <a href='http://threejs.org/'>THREE.js</a> and <a href='http://www.cannonjs.org/'>Cannon.js</a>. THREE.js is one of the most popular 3D engines on the web while Cannon.js represents a simple, fast and lightweight physics engine. With Cannon.js there is support for rigid bodies, friction, restitution, collision detection and constraints. THREE.BasicThirdPersonGame provides smooth controls and an adjustable third-person camera system. It comes with single module files for a clean separation of game logic.",link:"http://matthiasschuetz.com/three-basicthirdpersongame/"}},B=-.2,H=0,W=0,j=!1,Q=!1,X=!1,K=!1,Y=F.addChild().setRotation(B,0,0).setAlign(.5,.5,.5).setMountPoint(.5,-.5,1.5).setOrigin(.5,0,0).setSizeMode(1,1,1),J=new O(Y),Z=d(J),$={isMouseDown:!1,mouseX:null,mouseXStart:null,destinationX:0,lastDestinationX:0,rotationX:0,speedCurrent:0,speed:100,speedMax:.1,acceleration:2e-4,decay:.985,events:{onMouseDown:function(t){Q||($.lastDestinationX=H,$.destinationX=n($.destinationX),$.rotationX=n($.rotationX),$.mouseXStart=t.pageX||t.clientX,$.isMouseDown=!0)},onMouseMove:function(t){!Q&&$.isMouseDown&&(N.activeMarker&&(N.activeMarker=null),$.mouseX=$.mouseXStart-(t.pageX||t.clientX),$.destinationX=$.lastDestinationX-$.mouseX/$.speed)},onMouseUp:function(t){Q||($.isMouseDown=!1,W=s(H))}},bindEvents:function(){var t=document.querySelector("#famous-content");t.addEventListener("mousedown",$.events.onMouseDown),t.addEventListener("mousemove",$.events.onMouseMove),t.addEventListener("mouseup",$.events.onMouseUp),t.addEventListener("mouseleave",$.events.onMouseUp),t.addEventListener("touchstart",$.events.onMouseDown),t.addEventListener("touchmove",$.events.onMouseMove),t.addEventListener("touchend",$.events.onMouseUp)},applyRotation:function(){j||($.speedCurrent+=$.acceleration,$.speedCurrent*=$.decay,$.rotationX+=($.destinationX-$.rotationX)*$.speedCurrent,c($.rotationX),Y.setRotation(B,H,0))},setRotation:function(t,e){N.activeMarker=e,$.destinationX=$.rotationX=r(t)}},tt={containerElm:document.querySelector("#infowindow"),contentElm:document.querySelector("#infowindow-content"),closeBtnElm:document.querySelector("#infowindow-close"),titleElm:document.querySelector("#infowindow-title"),subtitleElm:document.querySelector("#infowindow-subtitle"),pictureRowElm:document.querySelector("#infowindow-imagerow"),pictureElm:document.querySelector("#infowindow-image"),textElm:document.querySelector("#infowindow-text"),linkElm:document.querySelector("#infowindow-websitelink"),hideTimeout:-1,hideTimeoutStarted:!1,bindEvents:function(){tt.containerElm.addEventListener("click",function(t){"infowindow"===t.target.id&&tt.hide()}),tt.closeBtnElm.addEventListener("click",function(){tt.hide()})},setContent:function(t){tt.titleElm.innerHTML=t.title,tt.subtitleElm.innerHTML=t.subtitle,tt.pictureElm.setAttribute("src",t.hidePicture?"":"webdevtools/content/"+t.img),tt.pictureRowElm.style.display=t.hidePicture?"none":"block",tt.textElm.innerHTML=t.text,tt.linkElm.setAttribute("href",t.hideLink?"":t.link),tt.linkElm.style.display=t.hideLink?"none":"block"},show:function(t){Q?(tt.containerElm.className="",tt.contentElm.className="transparent",setTimeout(function(){tt.setContent(t),tt.contentElm.className=""},K?50:400)):(Q=!0,tt.containerElm.className="transparent",tt.contentElm.className="transparent",setTimeout(function(){tt.setContent(t),tt.containerElm.className="",tt.contentElm.className=""},50))},reset:function(t){tt.hideTimeoutStarted&&(clearTimeout(tt.hideTimeout),l(),tt.containerElm.className="hidden",tt.hideTimeoutStarted=!1,Q=!1),X=!1,"function"==typeof t&&t()},hideContent:function(){Q&&(tt.containerElm.className="transparent",tt.contentElm.className="transparent")},hide:function(t){!tt.hideTimeoutStarted&&Q&&(tt.hideTimeoutStarted=!0,tt.containerElm.className="transparent",tt.contentElm.className="transparent",tt.hideTimeout=setTimeout(function(){tt.reset(t)},500))}};w.load("webdevtools/obj/landscape.obj",function(t){for(var e=0;e<t.length;e++){var i=t[e],s={vertices:i.vertices.concat(),normals:[],textureCoords:[],indices:i.indices.concat()},r=new C({buffers:[{name:"a_pos",data:i.vertices,size:3},{name:"a_normals",data:i.normals,size:3},{name:"a_texCoords",data:i.textureCoords,size:2},{name:"indices",data:i.indices,size:1}]}),n=new C({buffers:[{name:"a_pos",data:s.vertices,size:3},{name:"a_normals",data:s.normals,size:3},{name:"a_texCoords",data:s.textureCoords,size:2},{name:"indices",data:p(s.indices),size:1}],type:"LINES"}),o=Y.addChild();o.setAlign(0,0,0);var a=new M(o).setGeometry(r);a.setBaseColor(new A(G?"#0d0a06":"#ffffff"));var h=Y.addChild();h.setAlign(0,0,0);var u=new M(h).setGeometry(n).setFlatShading(!0);u.setBaseColor(new A("#f79e02")),h.setPosition(0,-1,0),g(),_(),y(),G||v()}}),b.init(),F.addComponent({onSizeChange:function(t){var e,i,s=Math.min(t[0],t[1]);s=240>s?240:s,e=s/2,i=-(3*(350-t[1])),i>=0&&(i=0),Y.setAbsoluteSize(e,e,e),Y.setPosition(0,0,i)}});var et=Y.addComponent({onUpdate:function(t){$.applyRotation(),Y.requestUpdateOnNextTick(et)}});Y.requestUpdate(et)},{"famous/components/Camera":1,"famous/components/GestureHandler":2,"famous/components/Position":3,"famous/components/Rotation":4,"famous/core/FamousEngine":9,"famous/dom-renderables/DOMElement":14,"famous/renderers/Context":36,"famous/transitions/Transitionable":40,"famous/utilities/Color":42,"famous/utilities/keyValueToArrays":44,"famous/webgl-geometries/Geometry":48,"famous/webgl-geometries/OBJLoader":50,"famous/webgl-geometries/primitives/Circle":53,"famous/webgl-geometries/primitives/Cylinder":54,"famous/webgl-geometries/primitives/Torus":61,"famous/webgl-materials/Material":63,"famous/webgl-renderables/Mesh":65,"famous/webgl-renderables/lights/AmbientLight":66,"famous/webgl-renderables/lights/PointLight":68,"famous/webgl-renderers/WebGLRenderer":75}]},{},[80]);
